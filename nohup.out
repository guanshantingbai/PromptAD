
================================================================================
主程序起始时间: 2025-12-20 15:09:22
================================================================================

python train_cls.py --dataset mvtec --gpu-id 0 --k-shot 1 --class_name carpet --root-dir ./result/prompt1
python train_cls.py --dataset mvtec --gpu-id 0 --k-shot 1 --class_name grid --root-dir ./result/prompt1
python train_cls.py --dataset mvtec --gpu-id 0 --k-shot 1 --class_name leather --root-dir ./result/prompt1
python train_cls.py --dataset mvtec --gpu-id 0 --k-shot 1 --class_name tile --root-dir ./result/prompt1
python train_cls.py --dataset mvtec --gpu-id 0 --k-shot 1 --class_name wood --root-dir ./result/prompt1
python train_cls.py --dataset mvtec --gpu-id 0 --k-shot 1 --class_name bottle --root-dir ./result/prompt1
python train_cls.py --dataset mvtec --gpu-id 0 --k-shot 1 --class_name cable --root-dir ./result/prompt1
python train_cls.py --dataset mvtec --gpu-id 0 --k-shot 1 --class_name capsule --root-dir ./result/prompt1
python train_cls.py --dataset mvtec --gpu-id 0 --k-shot 1 --class_name hazelnut --root-dir ./result/prompt1
python train_cls.py --dataset mvtec --gpu-id 0 --k-shot 1 --class_name metal_nut --root-dir ./result/prompt1
python train_cls.py --dataset mvtec --gpu-id 0 --k-shot 1 --class_name pill --root-dir ./result/prompt1
python train_cls.py --dataset mvtec --gpu-id 0 --k-shot 1 --class_name screw --root-dir ./result/prompt1
python train_cls.py --dataset mvtec --gpu-id 0 --k-shot 1 --class_name toothbrush --root-dir ./result/prompt1
python train_cls.py --dataset mvtec --gpu-id 0 --k-shot 1 --class_name transistor --root-dir ./result/prompt1
python train_cls.py --dataset mvtec --gpu-id 0 --k-shot 1 --class_name zipper --root-dir ./result/prompt1
python train_cls.py --dataset visa --gpu-id 0 --k-shot 1 --class_name candle --root-dir ./result/prompt1
python train_cls.py --dataset visa --gpu-id 0 --k-shot 1 --class_name capsules --root-dir ./result/prompt1
python train_cls.py --dataset visa --gpu-id 0 --k-shot 1 --class_name cashew --root-dir ./result/prompt1
python train_cls.py --dataset visa --gpu-id 0 --k-shot 1 --class_name chewinggum --root-dir ./result/prompt1
python train_cls.py --dataset visa --gpu-id 0 --k-shot 1 --class_name fryum --root-dir ./result/prompt1
python train_cls.py --dataset visa --gpu-id 0 --k-shot 1 --class_name macaroni1 --root-dir ./result/prompt1
python train_cls.py --dataset visa --gpu-id 0 --k-shot 1 --class_name macaroni2 --root-dir ./result/prompt1
python train_cls.py --dataset visa --gpu-id 0 --k-shot 1 --class_name pcb1 --root-dir ./result/prompt1
python train_cls.py --dataset visa --gpu-id 0 --k-shot 1 --class_name pcb2 --root-dir ./result/prompt1
python train_cls.py --dataset visa --gpu-id 0 --k-shot 1 --class_name pcb3 --root-dir ./result/prompt1
python train_cls.py --dataset visa --gpu-id 0 --k-shot 1 --class_name pcb4 --root-dir ./result/prompt1
python train_cls.py --dataset visa --gpu-id 0 --k-shot 1 --class_name pipe_fryum --root-dir ./result/prompt1
python train_cls.py --dataset mvtec --gpu-id 0 --k-shot 2 --class_name carpet --root-dir ./result/prompt1
python train_cls.py --dataset mvtec --gpu-id 0 --k-shot 2 --class_name grid --root-dir ./result/prompt1
python train_cls.py --dataset mvtec --gpu-id 0 --k-shot 2 --class_name leather --root-dir ./result/prompt1
python train_cls.py --dataset mvtec --gpu-id 0 --k-shot 2 --class_name tile --root-dir ./result/prompt1
python train_cls.py --dataset mvtec --gpu-id 0 --k-shot 2 --class_name wood --root-dir ./result/prompt1
python train_cls.py --dataset mvtec --gpu-id 0 --k-shot 2 --class_name bottle --root-dir ./result/prompt1
python train_cls.py --dataset mvtec --gpu-id 0 --k-shot 2 --class_name cable --root-dir ./result/prompt1
python train_cls.py --dataset mvtec --gpu-id 0 --k-shot 2 --class_name capsule --root-dir ./result/prompt1
python train_cls.py --dataset mvtec --gpu-id 0 --k-shot 2 --class_name hazelnut --root-dir ./result/prompt1
python train_cls.py --dataset mvtec --gpu-id 0 --k-shot 2 --class_name metal_nut --root-dir ./result/prompt1
python train_cls.py --dataset mvtec --gpu-id 0 --k-shot 2 --class_name pill --root-dir ./result/prompt1
python train_cls.py --dataset mvtec --gpu-id 0 --k-shot 2 --class_name screw --root-dir ./result/prompt1
python train_cls.py --dataset mvtec --gpu-id 0 --k-shot 2 --class_name toothbrush --root-dir ./result/prompt1
python train_cls.py --dataset mvtec --gpu-id 0 --k-shot 2 --class_name transistor --root-dir ./result/prompt1
python train_cls.py --dataset mvtec --gpu-id 0 --k-shot 2 --class_name zipper --root-dir ./result/prompt1
python train_cls.py --dataset visa --gpu-id 0 --k-shot 2 --class_name candle --root-dir ./result/prompt1
python train_cls.py --dataset visa --gpu-id 0 --k-shot 2 --class_name capsules --root-dir ./result/prompt1
python train_cls.py --dataset visa --gpu-id 0 --k-shot 2 --class_name cashew --root-dir ./result/prompt1
python train_cls.py --dataset visa --gpu-id 0 --k-shot 2 --class_name chewinggum --root-dir ./result/prompt1
python train_cls.py --dataset visa --gpu-id 0 --k-shot 2 --class_name fryum --root-dir ./result/prompt1
python train_cls.py --dataset visa --gpu-id 0 --k-shot 2 --class_name macaroni1 --root-dir ./result/prompt1
python train_cls.py --dataset visa --gpu-id 0 --k-shot 2 --class_name macaroni2 --root-dir ./result/prompt1
python train_cls.py --dataset visa --gpu-id 0 --k-shot 2 --class_name pcb1 --root-dir ./result/prompt1
python train_cls.py --dataset visa --gpu-id 0 --k-shot 2 --class_name pcb2 --root-dir ./result/prompt1
python train_cls.py --dataset visa --gpu-id 0 --k-shot 2 --class_name pcb3 --root-dir ./result/prompt1
python train_cls.py --dataset visa --gpu-id 0 --k-shot 2 --class_name pcb4 --root-dir ./result/prompt1
python train_cls.py --dataset visa --gpu-id 0 --k-shot 2 --class_name pipe_fryum --root-dir ./result/prompt1
python train_cls.py --dataset mvtec --gpu-id 0 --k-shot 4 --class_name carpet --root-dir ./result/prompt1
python train_cls.py --dataset mvtec --gpu-id 0 --k-shot 4 --class_name grid --root-dir ./result/prompt1
python train_cls.py --dataset mvtec --gpu-id 0 --k-shot 4 --class_name leather --root-dir ./result/prompt1
python train_cls.py --dataset mvtec --gpu-id 0 --k-shot 4 --class_name tile --root-dir ./result/prompt1
python train_cls.py --dataset mvtec --gpu-id 0 --k-shot 4 --class_name wood --root-dir ./result/prompt1
python train_cls.py --dataset mvtec --gpu-id 0 --k-shot 4 --class_name bottle --root-dir ./result/prompt1
python train_cls.py --dataset mvtec --gpu-id 0 --k-shot 4 --class_name cable --root-dir ./result/prompt1
python train_cls.py --dataset mvtec --gpu-id 0 --k-shot 4 --class_name capsule --root-dir ./result/prompt1
python train_cls.py --dataset mvtec --gpu-id 0 --k-shot 4 --class_name hazelnut --root-dir ./result/prompt1
python train_cls.py --dataset mvtec --gpu-id 0 --k-shot 4 --class_name metal_nut --root-dir ./result/prompt1
python train_cls.py --dataset mvtec --gpu-id 0 --k-shot 4 --class_name pill --root-dir ./result/prompt1
python train_cls.py --dataset mvtec --gpu-id 0 --k-shot 4 --class_name screw --root-dir ./result/prompt1
python train_cls.py --dataset mvtec --gpu-id 0 --k-shot 4 --class_name toothbrush --root-dir ./result/prompt1
python train_cls.py --dataset mvtec --gpu-id 0 --k-shot 4 --class_name transistor --root-dir ./result/prompt1
python train_cls.py --dataset mvtec --gpu-id 0 --k-shot 4 --class_name zipper --root-dir ./result/prompt1
python train_cls.py --dataset visa --gpu-id 0 --k-shot 4 --class_name candle --root-dir ./result/prompt1
python train_cls.py --dataset visa --gpu-id 0 --k-shot 4 --class_name capsules --root-dir ./result/prompt1
python train_cls.py --dataset visa --gpu-id 0 --k-shot 4 --class_name cashew --root-dir ./result/prompt1
python train_cls.py --dataset visa --gpu-id 0 --k-shot 4 --class_name chewinggum --root-dir ./result/prompt1
python train_cls.py --dataset visa --gpu-id 0 --k-shot 4 --class_name fryum --root-dir ./result/prompt1
python train_cls.py --dataset visa --gpu-id 0 --k-shot 4 --class_name macaroni1 --root-dir ./result/prompt1
python train_cls.py --dataset visa --gpu-id 0 --k-shot 4 --class_name macaroni2 --root-dir ./result/prompt1
python train_cls.py --dataset visa --gpu-id 0 --k-shot 4 --class_name pcb1 --root-dir ./result/prompt1
/home/zju/miniconda3/envs/prompt_ad/lib/python3.10/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
/home/zju/miniconda3/envs/prompt_ad/lib/python3.10/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)

================================================================================
Object:grid =========================== Image-AUROC:99.67
进程起始时间: 2025-12-20 15:09:24
进程终止时间: 2025-12-20 15:10:01
进程用时: 0小时 0分钟 36秒
================================================================================

/home/zju/miniconda3/envs/prompt_ad/lib/python3.10/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)

================================================================================
Object:carpet =========================== Image-AUROC:100.0
进程起始时间: 2025-12-20 15:09:24
进程终止时间: 2025-12-20 15:10:53
进程用时: 0小时 1分钟 29秒
================================================================================

/home/zju/miniconda3/envs/prompt_ad/lib/python3.10/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)

================================================================================
Object:leather =========================== Image-AUROC:100.0
进程起始时间: 2025-12-20 15:10:03
进程终止时间: 2025-12-20 15:11:29
进程用时: 0小时 1分钟 25秒
================================================================================

/home/zju/miniconda3/envs/prompt_ad/lib/python3.10/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)

================================================================================
Object:tile =========================== Image-AUROC:100.0
进程起始时间: 2025-12-20 15:10:56
进程终止时间: 2025-12-20 15:12:04
进程用时: 0小时 1分钟 8秒
================================================================================

/home/zju/miniconda3/envs/prompt_ad/lib/python3.10/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)

================================================================================
Object:wood =========================== Image-AUROC:99.65
进程起始时间: 2025-12-20 15:11:31
进程终止时间: 2025-12-20 15:12:39
进程用时: 0小时 1分钟 7秒
================================================================================

/home/zju/miniconda3/envs/prompt_ad/lib/python3.10/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)

================================================================================
Object:bottle =========================== Image-AUROC:98.57
进程起始时间: 2025-12-20 15:12:07
进程终止时间: 2025-12-20 15:12:50
进程用时: 0小时 0分钟 42秒
================================================================================

/home/zju/miniconda3/envs/prompt_ad/lib/python3.10/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)

================================================================================
Object:capsule =========================== Image-AUROC:77.26
进程起始时间: 2025-12-20 15:12:52
进程终止时间: 2025-12-20 15:14:24
进程用时: 0小时 1分钟 31秒
================================================================================


================================================================================
Object:cable =========================== Image-AUROC:80.66
进程起始时间: 2025-12-20 15:12:42
进程终止时间: 2025-12-20 15:14:26
进程用时: 0小时 1分钟 44秒
================================================================================

/home/zju/miniconda3/envs/prompt_ad/lib/python3.10/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
/home/zju/miniconda3/envs/prompt_ad/lib/python3.10/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)

================================================================================
Object:metal_nut =========================== Image-AUROC:94.77
进程起始时间: 2025-12-20 15:14:28
进程终止时间: 2025-12-20 15:15:16
进程用时: 0小时 0分钟 47秒
================================================================================

/home/zju/miniconda3/envs/prompt_ad/lib/python3.10/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)

================================================================================
Object:hazelnut =========================== Image-AUROC:96.21
进程起始时间: 2025-12-20 15:14:27
进程终止时间: 2025-12-20 15:15:44
进程用时: 0小时 1分钟 16秒
================================================================================

/home/zju/miniconda3/envs/prompt_ad/lib/python3.10/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)

================================================================================
Object:pill =========================== Image-AUROC:84.02
进程起始时间: 2025-12-20 15:15:18
进程终止时间: 2025-12-20 15:16:37
进程用时: 0小时 1分钟 18秒
================================================================================

/home/zju/miniconda3/envs/prompt_ad/lib/python3.10/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)

================================================================================
Object:screw =========================== Image-AUROC:61.59
进程起始时间: 2025-12-20 15:15:46
进程终止时间: 2025-12-20 15:16:45
进程用时: 0小时 0分钟 58秒
================================================================================

/home/zju/miniconda3/envs/prompt_ad/lib/python3.10/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)

================================================================================
Object:toothbrush =========================== Image-AUROC:83.33
进程起始时间: 2025-12-20 15:16:39
进程终止时间: 2025-12-20 15:17:17
进程用时: 0小时 0分钟 37秒
================================================================================

/home/zju/miniconda3/envs/prompt_ad/lib/python3.10/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)

================================================================================
Object:transistor =========================== Image-AUROC:85.79
进程起始时间: 2025-12-20 15:16:48
进程终止时间: 2025-12-20 15:18:03
进程用时: 0小时 1分钟 15秒
================================================================================

/home/zju/miniconda3/envs/prompt_ad/lib/python3.10/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
Traceback (most recent call last):
  File "/home/zju/mywork/PromptAD/train_cls.py", line 313, in <module>
    main(args)
  File "/home/zju/mywork/PromptAD/train_cls.py", line 213, in main
    train_dataloader, train_dataset_inst = get_dataloader_from_args(phase='train', perturbed=False, transform=model.transform, **kwargs)
  File "/home/zju/mywork/PromptAD/datasets/__init__.py", line 29, in get_dataloader_from_args
    dataset_inst = CLIPDataset(
  File "/home/zju/mywork/PromptAD/datasets/dataset.py", line 18, in __init__
    self.img_paths, self.gt_paths, self.labels, self.types = self.load_dataset(k_shot)  # self.labels => good : 0, anomaly : 1
  File "/home/zju/mywork/PromptAD/datasets/dataset.py", line 23, in load_dataset
    (test_img_tot_paths, test_gt_tot_paths, test_tot_labels, test_tot_types) = self.load_function(self.category,
  File "/home/zju/mywork/PromptAD/datasets/visa.py", line 51, in load_visa
    train_tot_types = load_phase(train_img_path, ground_truth_path)
  File "/home/zju/mywork/PromptAD/datasets/visa.py", line 20, in load_phase
    defect_types = os.listdir(root_path)
FileNotFoundError: [Errno 2] No such file or directory: '/data2/grj/pro_visa/1cls/candle/train'
/home/zju/miniconda3/envs/prompt_ad/lib/python3.10/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
Traceback (most recent call last):
  File "/home/zju/mywork/PromptAD/train_cls.py", line 313, in <module>
    main(args)
  File "/home/zju/mywork/PromptAD/train_cls.py", line 213, in main
    train_dataloader, train_dataset_inst = get_dataloader_from_args(phase='train', perturbed=False, transform=model.transform, **kwargs)
  File "/home/zju/mywork/PromptAD/datasets/__init__.py", line 29, in get_dataloader_from_args
    dataset_inst = CLIPDataset(
  File "/home/zju/mywork/PromptAD/datasets/dataset.py", line 18, in __init__
    self.img_paths, self.gt_paths, self.labels, self.types = self.load_dataset(k_shot)  # self.labels => good : 0, anomaly : 1
  File "/home/zju/mywork/PromptAD/datasets/dataset.py", line 23, in load_dataset
    (test_img_tot_paths, test_gt_tot_paths, test_tot_labels, test_tot_types) = self.load_function(self.category,
  File "/home/zju/mywork/PromptAD/datasets/visa.py", line 51, in load_visa
    train_tot_types = load_phase(train_img_path, ground_truth_path)
  File "/home/zju/mywork/PromptAD/datasets/visa.py", line 20, in load_phase
    defect_types = os.listdir(root_path)
FileNotFoundError: [Errno 2] No such file or directory: '/data2/grj/pro_visa/1cls/capsules/train'

================================================================================
Object:zipper =========================== Image-AUROC:94.3
进程起始时间: 2025-12-20 15:17:20
进程终止时间: 2025-12-20 15:18:15
进程用时: 0小时 0分钟 55秒
================================================================================

/home/zju/miniconda3/envs/prompt_ad/lib/python3.10/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
/home/zju/miniconda3/envs/prompt_ad/lib/python3.10/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
Traceback (most recent call last):
  File "/home/zju/mywork/PromptAD/train_cls.py", line 313, in <module>
    main(args)
  File "/home/zju/mywork/PromptAD/train_cls.py", line 213, in main
    train_dataloader, train_dataset_inst = get_dataloader_from_args(phase='train', perturbed=False, transform=model.transform, **kwargs)
  File "/home/zju/mywork/PromptAD/datasets/__init__.py", line 29, in get_dataloader_from_args
    dataset_inst = CLIPDataset(
  File "/home/zju/mywork/PromptAD/datasets/dataset.py", line 18, in __init__
    self.img_paths, self.gt_paths, self.labels, self.types = self.load_dataset(k_shot)  # self.labels => good : 0, anomaly : 1
  File "/home/zju/mywork/PromptAD/datasets/dataset.py", line 23, in load_dataset
    (test_img_tot_paths, test_gt_tot_paths, test_tot_labels, test_tot_types) = self.load_function(self.category,
  File "/home/zju/mywork/PromptAD/datasets/visa.py", line 51, in load_visa
    train_tot_types = load_phase(train_img_path, ground_truth_path)
  File "/home/zju/mywork/PromptAD/datasets/visa.py", line 20, in load_phase
    defect_types = os.listdir(root_path)
FileNotFoundError: [Errno 2] No such file or directory: '/data2/grj/pro_visa/1cls/cashew/train'
Traceback (most recent call last):
  File "/home/zju/mywork/PromptAD/train_cls.py", line 313, in <module>
    main(args)
  File "/home/zju/mywork/PromptAD/train_cls.py", line 213, in main
    train_dataloader, train_dataset_inst = get_dataloader_from_args(phase='train', perturbed=False, transform=model.transform, **kwargs)
  File "/home/zju/mywork/PromptAD/datasets/__init__.py", line 29, in get_dataloader_from_args
    dataset_inst = CLIPDataset(
  File "/home/zju/mywork/PromptAD/datasets/dataset.py", line 18, in __init__
    self.img_paths, self.gt_paths, self.labels, self.types = self.load_dataset(k_shot)  # self.labels => good : 0, anomaly : 1
  File "/home/zju/mywork/PromptAD/datasets/dataset.py", line 23, in load_dataset
    (test_img_tot_paths, test_gt_tot_paths, test_tot_labels, test_tot_types) = self.load_function(self.category,
  File "/home/zju/mywork/PromptAD/datasets/visa.py", line 51, in load_visa
    train_tot_types = load_phase(train_img_path, ground_truth_path)
  File "/home/zju/mywork/PromptAD/datasets/visa.py", line 20, in load_phase
    defect_types = os.listdir(root_path)
FileNotFoundError: [Errno 2] No such file or directory: '/data2/grj/pro_visa/1cls/chewinggum/train'
/home/zju/miniconda3/envs/prompt_ad/lib/python3.10/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
/home/zju/miniconda3/envs/prompt_ad/lib/python3.10/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
Traceback (most recent call last):
  File "/home/zju/mywork/PromptAD/train_cls.py", line 313, in <module>
    main(args)
  File "/home/zju/mywork/PromptAD/train_cls.py", line 213, in main
    train_dataloader, train_dataset_inst = get_dataloader_from_args(phase='train', perturbed=False, transform=model.transform, **kwargs)
  File "/home/zju/mywork/PromptAD/datasets/__init__.py", line 29, in get_dataloader_from_args
    dataset_inst = CLIPDataset(
  File "/home/zju/mywork/PromptAD/datasets/dataset.py", line 18, in __init__
    self.img_paths, self.gt_paths, self.labels, self.types = self.load_dataset(k_shot)  # self.labels => good : 0, anomaly : 1
  File "/home/zju/mywork/PromptAD/datasets/dataset.py", line 23, in load_dataset
    (test_img_tot_paths, test_gt_tot_paths, test_tot_labels, test_tot_types) = self.load_function(self.category,
  File "/home/zju/mywork/PromptAD/datasets/visa.py", line 51, in load_visa
    train_tot_types = load_phase(train_img_path, ground_truth_path)
  File "/home/zju/mywork/PromptAD/datasets/visa.py", line 20, in load_phase
    defect_types = os.listdir(root_path)
FileNotFoundError: [Errno 2] No such file or directory: '/data2/grj/pro_visa/1cls/fryum/train'
Traceback (most recent call last):
  File "/home/zju/mywork/PromptAD/train_cls.py", line 313, in <module>
    main(args)
  File "/home/zju/mywork/PromptAD/train_cls.py", line 213, in main
    train_dataloader, train_dataset_inst = get_dataloader_from_args(phase='train', perturbed=False, transform=model.transform, **kwargs)
  File "/home/zju/mywork/PromptAD/datasets/__init__.py", line 29, in get_dataloader_from_args
    dataset_inst = CLIPDataset(
  File "/home/zju/mywork/PromptAD/datasets/dataset.py", line 18, in __init__
    self.img_paths, self.gt_paths, self.labels, self.types = self.load_dataset(k_shot)  # self.labels => good : 0, anomaly : 1
  File "/home/zju/mywork/PromptAD/datasets/dataset.py", line 23, in load_dataset
    (test_img_tot_paths, test_gt_tot_paths, test_tot_labels, test_tot_types) = self.load_function(self.category,
  File "/home/zju/mywork/PromptAD/datasets/visa.py", line 51, in load_visa
    train_tot_types = load_phase(train_img_path, ground_truth_path)
  File "/home/zju/mywork/PromptAD/datasets/visa.py", line 20, in load_phase
    defect_types = os.listdir(root_path)
FileNotFoundError: [Errno 2] No such file or directory: '/data2/grj/pro_visa/1cls/macaroni1/train'
/home/zju/miniconda3/envs/prompt_ad/lib/python3.10/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
/home/zju/miniconda3/envs/prompt_ad/lib/python3.10/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
Traceback (most recent call last):
  File "/home/zju/mywork/PromptAD/train_cls.py", line 313, in <module>
    main(args)
  File "/home/zju/mywork/PromptAD/train_cls.py", line 213, in main
    train_dataloader, train_dataset_inst = get_dataloader_from_args(phase='train', perturbed=False, transform=model.transform, **kwargs)
  File "/home/zju/mywork/PromptAD/datasets/__init__.py", line 29, in get_dataloader_from_args
    dataset_inst = CLIPDataset(
  File "/home/zju/mywork/PromptAD/datasets/dataset.py", line 18, in __init__
    self.img_paths, self.gt_paths, self.labels, self.types = self.load_dataset(k_shot)  # self.labels => good : 0, anomaly : 1
  File "/home/zju/mywork/PromptAD/datasets/dataset.py", line 23, in load_dataset
    (test_img_tot_paths, test_gt_tot_paths, test_tot_labels, test_tot_types) = self.load_function(self.category,
  File "/home/zju/mywork/PromptAD/datasets/visa.py", line 51, in load_visa
    train_tot_types = load_phase(train_img_path, ground_truth_path)
  File "/home/zju/mywork/PromptAD/datasets/visa.py", line 20, in load_phase
    defect_types = os.listdir(root_path)
FileNotFoundError: [Errno 2] No such file or directory: '/data2/grj/pro_visa/1cls/macaroni2/train'
Traceback (most recent call last):
  File "/home/zju/mywork/PromptAD/train_cls.py", line 313, in <module>
    main(args)
  File "/home/zju/mywork/PromptAD/train_cls.py", line 213, in main
    train_dataloader, train_dataset_inst = get_dataloader_from_args(phase='train', perturbed=False, transform=model.transform, **kwargs)
  File "/home/zju/mywork/PromptAD/datasets/__init__.py", line 29, in get_dataloader_from_args
    dataset_inst = CLIPDataset(
  File "/home/zju/mywork/PromptAD/datasets/dataset.py", line 18, in __init__
    self.img_paths, self.gt_paths, self.labels, self.types = self.load_dataset(k_shot)  # self.labels => good : 0, anomaly : 1
  File "/home/zju/mywork/PromptAD/datasets/dataset.py", line 23, in load_dataset
    (test_img_tot_paths, test_gt_tot_paths, test_tot_labels, test_tot_types) = self.load_function(self.category,
  File "/home/zju/mywork/PromptAD/datasets/visa.py", line 51, in load_visa
    train_tot_types = load_phase(train_img_path, ground_truth_path)
  File "/home/zju/mywork/PromptAD/datasets/visa.py", line 20, in load_phase
    defect_types = os.listdir(root_path)
FileNotFoundError: [Errno 2] No such file or directory: '/data2/grj/pro_visa/1cls/pcb1/train'
/home/zju/miniconda3/envs/prompt_ad/lib/python3.10/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
/home/zju/miniconda3/envs/prompt_ad/lib/python3.10/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
Traceback (most recent call last):
  File "/home/zju/mywork/PromptAD/train_cls.py", line 313, in <module>
    main(args)
  File "/home/zju/mywork/PromptAD/train_cls.py", line 213, in main
    train_dataloader, train_dataset_inst = get_dataloader_from_args(phase='train', perturbed=False, transform=model.transform, **kwargs)
  File "/home/zju/mywork/PromptAD/datasets/__init__.py", line 29, in get_dataloader_from_args
    dataset_inst = CLIPDataset(
  File "/home/zju/mywork/PromptAD/datasets/dataset.py", line 18, in __init__
    self.img_paths, self.gt_paths, self.labels, self.types = self.load_dataset(k_shot)  # self.labels => good : 0, anomaly : 1
  File "/home/zju/mywork/PromptAD/datasets/dataset.py", line 23, in load_dataset
    (test_img_tot_paths, test_gt_tot_paths, test_tot_labels, test_tot_types) = self.load_function(self.category,
  File "/home/zju/mywork/PromptAD/datasets/visa.py", line 51, in load_visa
    train_tot_types = load_phase(train_img_path, ground_truth_path)
  File "/home/zju/mywork/PromptAD/datasets/visa.py", line 20, in load_phase
    defect_types = os.listdir(root_path)
FileNotFoundError: [Errno 2] No such file or directory: '/data2/grj/pro_visa/1cls/pcb2/train'
Traceback (most recent call last):
  File "/home/zju/mywork/PromptAD/train_cls.py", line 313, in <module>
    main(args)
  File "/home/zju/mywork/PromptAD/train_cls.py", line 213, in main
    train_dataloader, train_dataset_inst = get_dataloader_from_args(phase='train', perturbed=False, transform=model.transform, **kwargs)
  File "/home/zju/mywork/PromptAD/datasets/__init__.py", line 29, in get_dataloader_from_args
    dataset_inst = CLIPDataset(
  File "/home/zju/mywork/PromptAD/datasets/dataset.py", line 18, in __init__
    self.img_paths, self.gt_paths, self.labels, self.types = self.load_dataset(k_shot)  # self.labels => good : 0, anomaly : 1
  File "/home/zju/mywork/PromptAD/datasets/dataset.py", line 23, in load_dataset
    (test_img_tot_paths, test_gt_tot_paths, test_tot_labels, test_tot_types) = self.load_function(self.category,
  File "/home/zju/mywork/PromptAD/datasets/visa.py", line 51, in load_visa
    train_tot_types = load_phase(train_img_path, ground_truth_path)
  File "/home/zju/mywork/PromptAD/datasets/visa.py", line 20, in load_phase
    defect_types = os.listdir(root_path)
FileNotFoundError: [Errno 2] No such file or directory: '/data2/grj/pro_visa/1cls/pcb3/train'
/home/zju/miniconda3/envs/prompt_ad/lib/python3.10/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
/home/zju/miniconda3/envs/prompt_ad/lib/python3.10/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
Traceback (most recent call last):
  File "/home/zju/mywork/PromptAD/train_cls.py", line 313, in <module>
    main(args)
  File "/home/zju/mywork/PromptAD/train_cls.py", line 213, in main
    train_dataloader, train_dataset_inst = get_dataloader_from_args(phase='train', perturbed=False, transform=model.transform, **kwargs)
  File "/home/zju/mywork/PromptAD/datasets/__init__.py", line 29, in get_dataloader_from_args
    dataset_inst = CLIPDataset(
  File "/home/zju/mywork/PromptAD/datasets/dataset.py", line 18, in __init__
    self.img_paths, self.gt_paths, self.labels, self.types = self.load_dataset(k_shot)  # self.labels => good : 0, anomaly : 1
  File "/home/zju/mywork/PromptAD/datasets/dataset.py", line 23, in load_dataset
    (test_img_tot_paths, test_gt_tot_paths, test_tot_labels, test_tot_types) = self.load_function(self.category,
  File "/home/zju/mywork/PromptAD/datasets/visa.py", line 51, in load_visa
    train_tot_types = load_phase(train_img_path, ground_truth_path)
  File "/home/zju/mywork/PromptAD/datasets/visa.py", line 20, in load_phase
    defect_types = os.listdir(root_path)
FileNotFoundError: [Errno 2] No such file or directory: '/data2/grj/pro_visa/1cls/pcb4/train'
Traceback (most recent call last):
  File "/home/zju/mywork/PromptAD/train_cls.py", line 313, in <module>
    main(args)
  File "/home/zju/mywork/PromptAD/train_cls.py", line 213, in main
    train_dataloader, train_dataset_inst = get_dataloader_from_args(phase='train', perturbed=False, transform=model.transform, **kwargs)
  File "/home/zju/mywork/PromptAD/datasets/__init__.py", line 29, in get_dataloader_from_args
    dataset_inst = CLIPDataset(
  File "/home/zju/mywork/PromptAD/datasets/dataset.py", line 18, in __init__
    self.img_paths, self.gt_paths, self.labels, self.types = self.load_dataset(k_shot)  # self.labels => good : 0, anomaly : 1
  File "/home/zju/mywork/PromptAD/datasets/dataset.py", line 23, in load_dataset
    (test_img_tot_paths, test_gt_tot_paths, test_tot_labels, test_tot_types) = self.load_function(self.category,
  File "/home/zju/mywork/PromptAD/datasets/visa.py", line 51, in load_visa
    train_tot_types = load_phase(train_img_path, ground_truth_path)
  File "/home/zju/mywork/PromptAD/datasets/visa.py", line 20, in load_phase
    defect_types = os.listdir(root_path)
FileNotFoundError: [Errno 2] No such file or directory: '/data2/grj/pro_visa/1cls/pipe_fryum/train'
/home/zju/miniconda3/envs/prompt_ad/lib/python3.10/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
/home/zju/miniconda3/envs/prompt_ad/lib/python3.10/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)

================================================================================
Object:grid =========================== Image-AUROC:99.0
进程起始时间: 2025-12-20 15:18:42
进程终止时间: 2025-12-20 15:19:20
进程用时: 0小时 0分钟 37秒
================================================================================

/home/zju/miniconda3/envs/prompt_ad/lib/python3.10/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)

================================================================================
Object:carpet =========================== Image-AUROC:100.0
进程起始时间: 2025-12-20 15:18:41
进程终止时间: 2025-12-20 15:20:13
进程用时: 0小时 1分钟 32秒
================================================================================

/home/zju/miniconda3/envs/prompt_ad/lib/python3.10/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)

================================================================================
Object:leather =========================== Image-AUROC:100.0
进程起始时间: 2025-12-20 15:19:23
进程终止时间: 2025-12-20 15:20:50
进程用时: 0小时 1分钟 27秒
================================================================================

/home/zju/miniconda3/envs/prompt_ad/lib/python3.10/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)

================================================================================
Object:tile =========================== Image-AUROC:99.93
进程起始时间: 2025-12-20 15:20:16
进程终止时间: 2025-12-20 15:21:27
进程用时: 0小时 1分钟 11秒
================================================================================

/home/zju/miniconda3/envs/prompt_ad/lib/python3.10/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)

================================================================================
Object:wood =========================== Image-AUROC:99.65
进程起始时间: 2025-12-20 15:20:52
进程终止时间: 2025-12-20 15:22:04
进程用时: 0小时 1分钟 11秒
================================================================================

/home/zju/miniconda3/envs/prompt_ad/lib/python3.10/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)

================================================================================
Object:bottle =========================== Image-AUROC:98.25
进程起始时间: 2025-12-20 15:21:30
进程终止时间: 2025-12-20 15:22:14
进程用时: 0小时 0分钟 44秒
================================================================================

/home/zju/miniconda3/envs/prompt_ad/lib/python3.10/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)

================================================================================
Object:capsule =========================== Image-AUROC:80.65
进程起始时间: 2025-12-20 15:22:17
进程终止时间: 2025-12-20 15:23:51
进程用时: 0小时 1分钟 34秒
================================================================================


================================================================================
Object:cable =========================== Image-AUROC:86.0
进程起始时间: 2025-12-20 15:22:06
进程终止时间: 2025-12-20 15:23:53
进程用时: 0小时 1分钟 46秒
================================================================================

/home/zju/miniconda3/envs/prompt_ad/lib/python3.10/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
/home/zju/miniconda3/envs/prompt_ad/lib/python3.10/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)

================================================================================
Object:metal_nut =========================== Image-AUROC:88.71
进程起始时间: 2025-12-20 15:23:56
进程终止时间: 2025-12-20 15:24:45
进程用时: 0小时 0分钟 48秒
================================================================================

/home/zju/miniconda3/envs/prompt_ad/lib/python3.10/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)

================================================================================
Object:hazelnut =========================== Image-AUROC:91.14
进程起始时间: 2025-12-20 15:23:54
进程终止时间: 2025-12-20 15:25:14
进程用时: 0小时 1分钟 20秒
================================================================================

/home/zju/miniconda3/envs/prompt_ad/lib/python3.10/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)

================================================================================
Object:pill =========================== Image-AUROC:86.12
进程起始时间: 2025-12-20 15:24:47
进程终止时间: 2025-12-20 15:26:08
进程用时: 0小时 1分钟 20秒
================================================================================

/home/zju/miniconda3/envs/prompt_ad/lib/python3.10/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)

================================================================================
Object:screw =========================== Image-AUROC:79.57
进程起始时间: 2025-12-20 15:25:17
进程终止时间: 2025-12-20 15:26:17
进程用时: 0小时 1分钟 0秒
================================================================================

/home/zju/miniconda3/envs/prompt_ad/lib/python3.10/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)

================================================================================
Object:toothbrush =========================== Image-AUROC:89.44
进程起始时间: 2025-12-20 15:26:10
进程终止时间: 2025-12-20 15:26:51
进程用时: 0小时 0分钟 40秒
================================================================================

/home/zju/miniconda3/envs/prompt_ad/lib/python3.10/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)

================================================================================
Object:transistor =========================== Image-AUROC:78.08
进程起始时间: 2025-12-20 15:26:20
进程终止时间: 2025-12-20 15:27:40
进程用时: 0小时 1分钟 19秒
================================================================================

/home/zju/miniconda3/envs/prompt_ad/lib/python3.10/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
Traceback (most recent call last):
  File "/home/zju/mywork/PromptAD/train_cls.py", line 313, in <module>
    main(args)
  File "/home/zju/mywork/PromptAD/train_cls.py", line 213, in main
    train_dataloader, train_dataset_inst = get_dataloader_from_args(phase='train', perturbed=False, transform=model.transform, **kwargs)
  File "/home/zju/mywork/PromptAD/datasets/__init__.py", line 29, in get_dataloader_from_args
    dataset_inst = CLIPDataset(
  File "/home/zju/mywork/PromptAD/datasets/dataset.py", line 18, in __init__
    self.img_paths, self.gt_paths, self.labels, self.types = self.load_dataset(k_shot)  # self.labels => good : 0, anomaly : 1
  File "/home/zju/mywork/PromptAD/datasets/dataset.py", line 23, in load_dataset
    (test_img_tot_paths, test_gt_tot_paths, test_tot_labels, test_tot_types) = self.load_function(self.category,
  File "/home/zju/mywork/PromptAD/datasets/visa.py", line 51, in load_visa
    train_tot_types = load_phase(train_img_path, ground_truth_path)
  File "/home/zju/mywork/PromptAD/datasets/visa.py", line 20, in load_phase
    defect_types = os.listdir(root_path)
FileNotFoundError: [Errno 2] No such file or directory: '/data2/grj/pro_visa/1cls/candle/train'
/home/zju/miniconda3/envs/prompt_ad/lib/python3.10/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
Traceback (most recent call last):
  File "/home/zju/mywork/PromptAD/train_cls.py", line 313, in <module>
    main(args)
  File "/home/zju/mywork/PromptAD/train_cls.py", line 213, in main
    train_dataloader, train_dataset_inst = get_dataloader_from_args(phase='train', perturbed=False, transform=model.transform, **kwargs)
  File "/home/zju/mywork/PromptAD/datasets/__init__.py", line 29, in get_dataloader_from_args
    dataset_inst = CLIPDataset(
  File "/home/zju/mywork/PromptAD/datasets/dataset.py", line 18, in __init__
    self.img_paths, self.gt_paths, self.labels, self.types = self.load_dataset(k_shot)  # self.labels => good : 0, anomaly : 1
  File "/home/zju/mywork/PromptAD/datasets/dataset.py", line 23, in load_dataset
    (test_img_tot_paths, test_gt_tot_paths, test_tot_labels, test_tot_types) = self.load_function(self.category,
  File "/home/zju/mywork/PromptAD/datasets/visa.py", line 51, in load_visa
    train_tot_types = load_phase(train_img_path, ground_truth_path)
  File "/home/zju/mywork/PromptAD/datasets/visa.py", line 20, in load_phase
    defect_types = os.listdir(root_path)
FileNotFoundError: [Errno 2] No such file or directory: '/data2/grj/pro_visa/1cls/capsules/train'

================================================================================
Object:zipper =========================== Image-AUROC:95.46
进程起始时间: 2025-12-20 15:26:54
进程终止时间: 2025-12-20 15:27:51
进程用时: 0小时 0分钟 57秒
================================================================================

/home/zju/miniconda3/envs/prompt_ad/lib/python3.10/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
/home/zju/miniconda3/envs/prompt_ad/lib/python3.10/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
Traceback (most recent call last):
  File "/home/zju/mywork/PromptAD/train_cls.py", line 313, in <module>
    main(args)
  File "/home/zju/mywork/PromptAD/train_cls.py", line 213, in main
    train_dataloader, train_dataset_inst = get_dataloader_from_args(phase='train', perturbed=False, transform=model.transform, **kwargs)
  File "/home/zju/mywork/PromptAD/datasets/__init__.py", line 29, in get_dataloader_from_args
    dataset_inst = CLIPDataset(
  File "/home/zju/mywork/PromptAD/datasets/dataset.py", line 18, in __init__
    self.img_paths, self.gt_paths, self.labels, self.types = self.load_dataset(k_shot)  # self.labels => good : 0, anomaly : 1
  File "/home/zju/mywork/PromptAD/datasets/dataset.py", line 23, in load_dataset
    (test_img_tot_paths, test_gt_tot_paths, test_tot_labels, test_tot_types) = self.load_function(self.category,
  File "/home/zju/mywork/PromptAD/datasets/visa.py", line 51, in load_visa
    train_tot_types = load_phase(train_img_path, ground_truth_path)
  File "/home/zju/mywork/PromptAD/datasets/visa.py", line 20, in load_phase
    defect_types = os.listdir(root_path)
FileNotFoundError: [Errno 2] No such file or directory: '/data2/grj/pro_visa/1cls/cashew/train'
Traceback (most recent call last):
  File "/home/zju/mywork/PromptAD/train_cls.py", line 313, in <module>
    main(args)
  File "/home/zju/mywork/PromptAD/train_cls.py", line 213, in main
    train_dataloader, train_dataset_inst = get_dataloader_from_args(phase='train', perturbed=False, transform=model.transform, **kwargs)
  File "/home/zju/mywork/PromptAD/datasets/__init__.py", line 29, in get_dataloader_from_args
    dataset_inst = CLIPDataset(
  File "/home/zju/mywork/PromptAD/datasets/dataset.py", line 18, in __init__
    self.img_paths, self.gt_paths, self.labels, self.types = self.load_dataset(k_shot)  # self.labels => good : 0, anomaly : 1
  File "/home/zju/mywork/PromptAD/datasets/dataset.py", line 23, in load_dataset
    (test_img_tot_paths, test_gt_tot_paths, test_tot_labels, test_tot_types) = self.load_function(self.category,
  File "/home/zju/mywork/PromptAD/datasets/visa.py", line 51, in load_visa
    train_tot_types = load_phase(train_img_path, ground_truth_path)
  File "/home/zju/mywork/PromptAD/datasets/visa.py", line 20, in load_phase
    defect_types = os.listdir(root_path)
FileNotFoundError: [Errno 2] No such file or directory: '/data2/grj/pro_visa/1cls/chewinggum/train'
/home/zju/miniconda3/envs/prompt_ad/lib/python3.10/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
/home/zju/miniconda3/envs/prompt_ad/lib/python3.10/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
Traceback (most recent call last):
  File "/home/zju/mywork/PromptAD/train_cls.py", line 313, in <module>
    main(args)
  File "/home/zju/mywork/PromptAD/train_cls.py", line 213, in main
    train_dataloader, train_dataset_inst = get_dataloader_from_args(phase='train', perturbed=False, transform=model.transform, **kwargs)
  File "/home/zju/mywork/PromptAD/datasets/__init__.py", line 29, in get_dataloader_from_args
    dataset_inst = CLIPDataset(
  File "/home/zju/mywork/PromptAD/datasets/dataset.py", line 18, in __init__
    self.img_paths, self.gt_paths, self.labels, self.types = self.load_dataset(k_shot)  # self.labels => good : 0, anomaly : 1
  File "/home/zju/mywork/PromptAD/datasets/dataset.py", line 23, in load_dataset
    (test_img_tot_paths, test_gt_tot_paths, test_tot_labels, test_tot_types) = self.load_function(self.category,
  File "/home/zju/mywork/PromptAD/datasets/visa.py", line 51, in load_visa
    train_tot_types = load_phase(train_img_path, ground_truth_path)
  File "/home/zju/mywork/PromptAD/datasets/visa.py", line 20, in load_phase
    defect_types = os.listdir(root_path)
FileNotFoundError: [Errno 2] No such file or directory: '/data2/grj/pro_visa/1cls/fryum/train'
Traceback (most recent call last):
  File "/home/zju/mywork/PromptAD/train_cls.py", line 313, in <module>
    main(args)
  File "/home/zju/mywork/PromptAD/train_cls.py", line 213, in main
    train_dataloader, train_dataset_inst = get_dataloader_from_args(phase='train', perturbed=False, transform=model.transform, **kwargs)
  File "/home/zju/mywork/PromptAD/datasets/__init__.py", line 29, in get_dataloader_from_args
    dataset_inst = CLIPDataset(
  File "/home/zju/mywork/PromptAD/datasets/dataset.py", line 18, in __init__
    self.img_paths, self.gt_paths, self.labels, self.types = self.load_dataset(k_shot)  # self.labels => good : 0, anomaly : 1
  File "/home/zju/mywork/PromptAD/datasets/dataset.py", line 23, in load_dataset
    (test_img_tot_paths, test_gt_tot_paths, test_tot_labels, test_tot_types) = self.load_function(self.category,
  File "/home/zju/mywork/PromptAD/datasets/visa.py", line 51, in load_visa
    train_tot_types = load_phase(train_img_path, ground_truth_path)
  File "/home/zju/mywork/PromptAD/datasets/visa.py", line 20, in load_phase
    defect_types = os.listdir(root_path)
FileNotFoundError: [Errno 2] No such file or directory: '/data2/grj/pro_visa/1cls/macaroni1/train'
/home/zju/miniconda3/envs/prompt_ad/lib/python3.10/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
/home/zju/miniconda3/envs/prompt_ad/lib/python3.10/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
Traceback (most recent call last):
  File "/home/zju/mywork/PromptAD/train_cls.py", line 313, in <module>
    main(args)
  File "/home/zju/mywork/PromptAD/train_cls.py", line 213, in main
    train_dataloader, train_dataset_inst = get_dataloader_from_args(phase='train', perturbed=False, transform=model.transform, **kwargs)
  File "/home/zju/mywork/PromptAD/datasets/__init__.py", line 29, in get_dataloader_from_args
    dataset_inst = CLIPDataset(
  File "/home/zju/mywork/PromptAD/datasets/dataset.py", line 18, in __init__
    self.img_paths, self.gt_paths, self.labels, self.types = self.load_dataset(k_shot)  # self.labels => good : 0, anomaly : 1
  File "/home/zju/mywork/PromptAD/datasets/dataset.py", line 23, in load_dataset
    (test_img_tot_paths, test_gt_tot_paths, test_tot_labels, test_tot_types) = self.load_function(self.category,
  File "/home/zju/mywork/PromptAD/datasets/visa.py", line 51, in load_visa
    train_tot_types = load_phase(train_img_path, ground_truth_path)
  File "/home/zju/mywork/PromptAD/datasets/visa.py", line 20, in load_phase
    defect_types = os.listdir(root_path)
FileNotFoundError: [Errno 2] No such file or directory: '/data2/grj/pro_visa/1cls/macaroni2/train'
Traceback (most recent call last):
  File "/home/zju/mywork/PromptAD/train_cls.py", line 313, in <module>
    main(args)
  File "/home/zju/mywork/PromptAD/train_cls.py", line 213, in main
    train_dataloader, train_dataset_inst = get_dataloader_from_args(phase='train', perturbed=False, transform=model.transform, **kwargs)
  File "/home/zju/mywork/PromptAD/datasets/__init__.py", line 29, in get_dataloader_from_args
    dataset_inst = CLIPDataset(
  File "/home/zju/mywork/PromptAD/datasets/dataset.py", line 18, in __init__
    self.img_paths, self.gt_paths, self.labels, self.types = self.load_dataset(k_shot)  # self.labels => good : 0, anomaly : 1
  File "/home/zju/mywork/PromptAD/datasets/dataset.py", line 23, in load_dataset
    (test_img_tot_paths, test_gt_tot_paths, test_tot_labels, test_tot_types) = self.load_function(self.category,
  File "/home/zju/mywork/PromptAD/datasets/visa.py", line 51, in load_visa
    train_tot_types = load_phase(train_img_path, ground_truth_path)
  File "/home/zju/mywork/PromptAD/datasets/visa.py", line 20, in load_phase
    defect_types = os.listdir(root_path)
FileNotFoundError: [Errno 2] No such file or directory: '/data2/grj/pro_visa/1cls/pcb1/train'
/home/zju/miniconda3/envs/prompt_ad/lib/python3.10/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
/home/zju/miniconda3/envs/prompt_ad/lib/python3.10/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
Traceback (most recent call last):
  File "/home/zju/mywork/PromptAD/train_cls.py", line 313, in <module>
    main(args)
  File "/home/zju/mywork/PromptAD/train_cls.py", line 213, in main
    train_dataloader, train_dataset_inst = get_dataloader_from_args(phase='train', perturbed=False, transform=model.transform, **kwargs)
  File "/home/zju/mywork/PromptAD/datasets/__init__.py", line 29, in get_dataloader_from_args
    dataset_inst = CLIPDataset(
  File "/home/zju/mywork/PromptAD/datasets/dataset.py", line 18, in __init__
    self.img_paths, self.gt_paths, self.labels, self.types = self.load_dataset(k_shot)  # self.labels => good : 0, anomaly : 1
  File "/home/zju/mywork/PromptAD/datasets/dataset.py", line 23, in load_dataset
    (test_img_tot_paths, test_gt_tot_paths, test_tot_labels, test_tot_types) = self.load_function(self.category,
  File "/home/zju/mywork/PromptAD/datasets/visa.py", line 51, in load_visa
    train_tot_types = load_phase(train_img_path, ground_truth_path)
  File "/home/zju/mywork/PromptAD/datasets/visa.py", line 20, in load_phase
    defect_types = os.listdir(root_path)
FileNotFoundError: [Errno 2] No such file or directory: '/data2/grj/pro_visa/1cls/pcb2/train'
Traceback (most recent call last):
  File "/home/zju/mywork/PromptAD/train_cls.py", line 313, in <module>
    main(args)
  File "/home/zju/mywork/PromptAD/train_cls.py", line 213, in main
    train_dataloader, train_dataset_inst = get_dataloader_from_args(phase='train', perturbed=False, transform=model.transform, **kwargs)
  File "/home/zju/mywork/PromptAD/datasets/__init__.py", line 29, in get_dataloader_from_args
    dataset_inst = CLIPDataset(
  File "/home/zju/mywork/PromptAD/datasets/dataset.py", line 18, in __init__
    self.img_paths, self.gt_paths, self.labels, self.types = self.load_dataset(k_shot)  # self.labels => good : 0, anomaly : 1
  File "/home/zju/mywork/PromptAD/datasets/dataset.py", line 23, in load_dataset
    (test_img_tot_paths, test_gt_tot_paths, test_tot_labels, test_tot_types) = self.load_function(self.category,
  File "/home/zju/mywork/PromptAD/datasets/visa.py", line 51, in load_visa
    train_tot_types = load_phase(train_img_path, ground_truth_path)
  File "/home/zju/mywork/PromptAD/datasets/visa.py", line 20, in load_phase
    defect_types = os.listdir(root_path)
FileNotFoundError: [Errno 2] No such file or directory: '/data2/grj/pro_visa/1cls/pcb3/train'
/home/zju/miniconda3/envs/prompt_ad/lib/python3.10/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
/home/zju/miniconda3/envs/prompt_ad/lib/python3.10/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
Traceback (most recent call last):
  File "/home/zju/mywork/PromptAD/train_cls.py", line 313, in <module>
    main(args)
  File "/home/zju/mywork/PromptAD/train_cls.py", line 213, in main
    train_dataloader, train_dataset_inst = get_dataloader_from_args(phase='train', perturbed=False, transform=model.transform, **kwargs)
  File "/home/zju/mywork/PromptAD/datasets/__init__.py", line 29, in get_dataloader_from_args
    dataset_inst = CLIPDataset(
  File "/home/zju/mywork/PromptAD/datasets/dataset.py", line 18, in __init__
    self.img_paths, self.gt_paths, self.labels, self.types = self.load_dataset(k_shot)  # self.labels => good : 0, anomaly : 1
  File "/home/zju/mywork/PromptAD/datasets/dataset.py", line 23, in load_dataset
    (test_img_tot_paths, test_gt_tot_paths, test_tot_labels, test_tot_types) = self.load_function(self.category,
  File "/home/zju/mywork/PromptAD/datasets/visa.py", line 51, in load_visa
    train_tot_types = load_phase(train_img_path, ground_truth_path)
  File "/home/zju/mywork/PromptAD/datasets/visa.py", line 20, in load_phase
    defect_types = os.listdir(root_path)
FileNotFoundError: [Errno 2] No such file or directory: '/data2/grj/pro_visa/1cls/pcb4/train'
Traceback (most recent call last):
  File "/home/zju/mywork/PromptAD/train_cls.py", line 313, in <module>
    main(args)
  File "/home/zju/mywork/PromptAD/train_cls.py", line 213, in main
    train_dataloader, train_dataset_inst = get_dataloader_from_args(phase='train', perturbed=False, transform=model.transform, **kwargs)
  File "/home/zju/mywork/PromptAD/datasets/__init__.py", line 29, in get_dataloader_from_args
    dataset_inst = CLIPDataset(
  File "/home/zju/mywork/PromptAD/datasets/dataset.py", line 18, in __init__
    self.img_paths, self.gt_paths, self.labels, self.types = self.load_dataset(k_shot)  # self.labels => good : 0, anomaly : 1
  File "/home/zju/mywork/PromptAD/datasets/dataset.py", line 23, in load_dataset
    (test_img_tot_paths, test_gt_tot_paths, test_tot_labels, test_tot_types) = self.load_function(self.category,
  File "/home/zju/mywork/PromptAD/datasets/visa.py", line 51, in load_visa
    train_tot_types = load_phase(train_img_path, ground_truth_path)
  File "/home/zju/mywork/PromptAD/datasets/visa.py", line 20, in load_phase
    defect_types = os.listdir(root_path)
FileNotFoundError: [Errno 2] No such file or directory: '/data2/grj/pro_visa/1cls/pipe_fryum/train'
/home/zju/miniconda3/envs/prompt_ad/lib/python3.10/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
/home/zju/miniconda3/envs/prompt_ad/lib/python3.10/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)

================================================================================
Object:grid =========================== Image-AUROC:99.92
进程起始时间: 2025-12-20 15:28:19
进程终止时间: 2025-12-20 15:29:00
进程用时: 0小时 0分钟 40秒
================================================================================

/home/zju/miniconda3/envs/prompt_ad/lib/python3.10/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)

================================================================================
Object:carpet =========================== Image-AUROC:100.0
进程起始时间: 2025-12-20 15:28:17
进程终止时间: 2025-12-20 15:29:56
进程用时: 0小时 1分钟 38秒
================================================================================

/home/zju/miniconda3/envs/prompt_ad/lib/python3.10/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)

================================================================================
Object:leather =========================== Image-AUROC:100.0
进程起始时间: 2025-12-20 15:29:02
进程终止时间: 2025-12-20 15:30:35
进程用时: 0小时 1分钟 32秒
================================================================================

/home/zju/miniconda3/envs/prompt_ad/lib/python3.10/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)

================================================================================
Object:tile =========================== Image-AUROC:99.96
进程起始时间: 2025-12-20 15:29:59
进程终止时间: 2025-12-20 15:31:14
进程用时: 0小时 1分钟 15秒
================================================================================

/home/zju/miniconda3/envs/prompt_ad/lib/python3.10/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)

================================================================================
Object:wood =========================== Image-AUROC:100.0
进程起始时间: 2025-12-20 15:30:38
进程终止时间: 2025-12-20 15:31:55
进程用时: 0小时 1分钟 17秒
================================================================================

/home/zju/miniconda3/envs/prompt_ad/lib/python3.10/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)

================================================================================
Object:bottle =========================== Image-AUROC:97.78
进程起始时间: 2025-12-20 15:31:17
进程终止时间: 2025-12-20 15:32:05
进程用时: 0小时 0分钟 47秒
================================================================================

/home/zju/miniconda3/envs/prompt_ad/lib/python3.10/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)

================================================================================
Object:capsule =========================== Image-AUROC:85.24
进程起始时间: 2025-12-20 15:32:07
进程终止时间: 2025-12-20 15:33:47
进程用时: 0小时 1分钟 39秒
================================================================================

/home/zju/miniconda3/envs/prompt_ad/lib/python3.10/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)

================================================================================
Object:cable =========================== Image-AUROC:93.78
进程起始时间: 2025-12-20 15:31:58
进程终止时间: 2025-12-20 15:33:50
进程用时: 0小时 1分钟 52秒
================================================================================

/home/zju/miniconda3/envs/prompt_ad/lib/python3.10/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)

================================================================================
Object:metal_nut =========================== Image-AUROC:91.2
进程起始时间: 2025-12-20 15:33:53
进程终止时间: 2025-12-20 15:34:44
进程用时: 0小时 0分钟 51秒
================================================================================

/home/zju/miniconda3/envs/prompt_ad/lib/python3.10/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)

================================================================================
Object:hazelnut =========================== Image-AUROC:92.64
进程起始时间: 2025-12-20 15:33:49
进程终止时间: 2025-12-20 15:35:15
进程用时: 0小时 1分钟 26秒
================================================================================

/home/zju/miniconda3/envs/prompt_ad/lib/python3.10/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)

================================================================================
Object:pill =========================== Image-AUROC:87.21
进程起始时间: 2025-12-20 15:34:47
进程终止时间: 2025-12-20 15:36:12
进程用时: 0小时 1分钟 25秒
================================================================================

/home/zju/miniconda3/envs/prompt_ad/lib/python3.10/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)

================================================================================
Object:screw =========================== Image-AUROC:72.02
进程起始时间: 2025-12-20 15:35:18
进程终止时间: 2025-12-20 15:36:21
进程用时: 0小时 1分钟 3秒
================================================================================

/home/zju/miniconda3/envs/prompt_ad/lib/python3.10/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)

================================================================================
Object:toothbrush =========================== Image-AUROC:90.28
进程起始时间: 2025-12-20 15:36:15
进程终止时间: 2025-12-20 15:37:01
进程用时: 0小时 0分钟 45秒
================================================================================

/home/zju/miniconda3/envs/prompt_ad/lib/python3.10/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)

================================================================================
Object:transistor =========================== Image-AUROC:90.08
进程起始时间: 2025-12-20 15:36:24
进程终止时间: 2025-12-20 15:37:50
进程用时: 0小时 1分钟 25秒
================================================================================

/home/zju/miniconda3/envs/prompt_ad/lib/python3.10/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
Traceback (most recent call last):
  File "/home/zju/mywork/PromptAD/train_cls.py", line 313, in <module>
    main(args)
  File "/home/zju/mywork/PromptAD/train_cls.py", line 213, in main
    train_dataloader, train_dataset_inst = get_dataloader_from_args(phase='train', perturbed=False, transform=model.transform, **kwargs)
  File "/home/zju/mywork/PromptAD/datasets/__init__.py", line 29, in get_dataloader_from_args
    dataset_inst = CLIPDataset(
  File "/home/zju/mywork/PromptAD/datasets/dataset.py", line 18, in __init__
    self.img_paths, self.gt_paths, self.labels, self.types = self.load_dataset(k_shot)  # self.labels => good : 0, anomaly : 1
  File "/home/zju/mywork/PromptAD/datasets/dataset.py", line 23, in load_dataset
    (test_img_tot_paths, test_gt_tot_paths, test_tot_labels, test_tot_types) = self.load_function(self.category,
  File "/home/zju/mywork/PromptAD/datasets/visa.py", line 51, in load_visa
    train_tot_types = load_phase(train_img_path, ground_truth_path)
  File "/home/zju/mywork/PromptAD/datasets/visa.py", line 20, in load_phase
    defect_types = os.listdir(root_path)
FileNotFoundError: [Errno 2] No such file or directory: '/data2/grj/pro_visa/1cls/candle/train'
/home/zju/miniconda3/envs/prompt_ad/lib/python3.10/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
Traceback (most recent call last):
  File "/home/zju/mywork/PromptAD/train_cls.py", line 313, in <module>
    main(args)
  File "/home/zju/mywork/PromptAD/train_cls.py", line 213, in main
    train_dataloader, train_dataset_inst = get_dataloader_from_args(phase='train', perturbed=False, transform=model.transform, **kwargs)
  File "/home/zju/mywork/PromptAD/datasets/__init__.py", line 29, in get_dataloader_from_args
    dataset_inst = CLIPDataset(
  File "/home/zju/mywork/PromptAD/datasets/dataset.py", line 18, in __init__
    self.img_paths, self.gt_paths, self.labels, self.types = self.load_dataset(k_shot)  # self.labels => good : 0, anomaly : 1
  File "/home/zju/mywork/PromptAD/datasets/dataset.py", line 23, in load_dataset
    (test_img_tot_paths, test_gt_tot_paths, test_tot_labels, test_tot_types) = self.load_function(self.category,
  File "/home/zju/mywork/PromptAD/datasets/visa.py", line 51, in load_visa
    train_tot_types = load_phase(train_img_path, ground_truth_path)
  File "/home/zju/mywork/PromptAD/datasets/visa.py", line 20, in load_phase
    defect_types = os.listdir(root_path)
FileNotFoundError: [Errno 2] No such file or directory: '/data2/grj/pro_visa/1cls/capsules/train'
/home/zju/miniconda3/envs/prompt_ad/lib/python3.10/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)

================================================================================
Object:zipper =========================== Image-AUROC:96.45
进程起始时间: 2025-12-20 15:37:04
进程终止时间: 2025-12-20 15:38:05
进程用时: 0小时 1分钟 1秒
================================================================================

Traceback (most recent call last):
  File "/home/zju/mywork/PromptAD/train_cls.py", line 313, in <module>
    main(args)
  File "/home/zju/mywork/PromptAD/train_cls.py", line 213, in main
    train_dataloader, train_dataset_inst = get_dataloader_from_args(phase='train', perturbed=False, transform=model.transform, **kwargs)
  File "/home/zju/mywork/PromptAD/datasets/__init__.py", line 29, in get_dataloader_from_args
    dataset_inst = CLIPDataset(
  File "/home/zju/mywork/PromptAD/datasets/dataset.py", line 18, in __init__
    self.img_paths, self.gt_paths, self.labels, self.types = self.load_dataset(k_shot)  # self.labels => good : 0, anomaly : 1
  File "/home/zju/mywork/PromptAD/datasets/dataset.py", line 23, in load_dataset
    (test_img_tot_paths, test_gt_tot_paths, test_tot_labels, test_tot_types) = self.load_function(self.category,
  File "/home/zju/mywork/PromptAD/datasets/visa.py", line 51, in load_visa
    train_tot_types = load_phase(train_img_path, ground_truth_path)
  File "/home/zju/mywork/PromptAD/datasets/visa.py", line 20, in load_phase
    defect_types = os.listdir(root_path)
FileNotFoundError: [Errno 2] No such file or directory: '/data2/grj/pro_visa/1cls/cashew/train'
/home/zju/miniconda3/envs/prompt_ad/lib/python3.10/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
/home/zju/miniconda3/envs/prompt_ad/lib/python3.10/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
Traceback (most recent call last):
  File "/home/zju/mywork/PromptAD/train_cls.py", line 313, in <module>
    main(args)
  File "/home/zju/mywork/PromptAD/train_cls.py", line 213, in main
    train_dataloader, train_dataset_inst = get_dataloader_from_args(phase='train', perturbed=False, transform=model.transform, **kwargs)
  File "/home/zju/mywork/PromptAD/datasets/__init__.py", line 29, in get_dataloader_from_args
    dataset_inst = CLIPDataset(
  File "/home/zju/mywork/PromptAD/datasets/dataset.py", line 18, in __init__
    self.img_paths, self.gt_paths, self.labels, self.types = self.load_dataset(k_shot)  # self.labels => good : 0, anomaly : 1
  File "/home/zju/mywork/PromptAD/datasets/dataset.py", line 23, in load_dataset
    (test_img_tot_paths, test_gt_tot_paths, test_tot_labels, test_tot_types) = self.load_function(self.category,
  File "/home/zju/mywork/PromptAD/datasets/visa.py", line 51, in load_visa
    train_tot_types = load_phase(train_img_path, ground_truth_path)
  File "/home/zju/mywork/PromptAD/datasets/visa.py", line 20, in load_phase
    defect_types = os.listdir(root_path)
FileNotFoundError: [Errno 2] No such file or directory: '/data2/grj/pro_visa/1cls/fryum/train'
Traceback (most recent call last):
  File "/home/zju/mywork/PromptAD/train_cls.py", line 313, in <module>
    main(args)
  File "/home/zju/mywork/PromptAD/train_cls.py", line 213, in main
    train_dataloader, train_dataset_inst = get_dataloader_from_args(phase='train', perturbed=False, transform=model.transform, **kwargs)
  File "/home/zju/mywork/PromptAD/datasets/__init__.py", line 29, in get_dataloader_from_args
    dataset_inst = CLIPDataset(
  File "/home/zju/mywork/PromptAD/datasets/dataset.py", line 18, in __init__
    self.img_paths, self.gt_paths, self.labels, self.types = self.load_dataset(k_shot)  # self.labels => good : 0, anomaly : 1
  File "/home/zju/mywork/PromptAD/datasets/dataset.py", line 23, in load_dataset
    (test_img_tot_paths, test_gt_tot_paths, test_tot_labels, test_tot_types) = self.load_function(self.category,
  File "/home/zju/mywork/PromptAD/datasets/visa.py", line 51, in load_visa
    train_tot_types = load_phase(train_img_path, ground_truth_path)
  File "/home/zju/mywork/PromptAD/datasets/visa.py", line 20, in load_phase
    defect_types = os.listdir(root_path)
FileNotFoundError: [Errno 2] No such file or directory: '/data2/grj/pro_visa/1cls/chewinggum/train'
/home/zju/miniconda3/envs/prompt_ad/lib/python3.10/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
/home/zju/miniconda3/envs/prompt_ad/lib/python3.10/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
Traceback (most recent call last):
  File "/home/zju/mywork/PromptAD/train_cls.py", line 313, in <module>
    main(args)
  File "/home/zju/mywork/PromptAD/train_cls.py", line 213, in main
    train_dataloader, train_dataset_inst = get_dataloader_from_args(phase='train', perturbed=False, transform=model.transform, **kwargs)
  File "/home/zju/mywork/PromptAD/datasets/__init__.py", line 29, in get_dataloader_from_args
    dataset_inst = CLIPDataset(
  File "/home/zju/mywork/PromptAD/datasets/dataset.py", line 18, in __init__
    self.img_paths, self.gt_paths, self.labels, self.types = self.load_dataset(k_shot)  # self.labels => good : 0, anomaly : 1
  File "/home/zju/mywork/PromptAD/datasets/dataset.py", line 23, in load_dataset
    (test_img_tot_paths, test_gt_tot_paths, test_tot_labels, test_tot_types) = self.load_function(self.category,
  File "/home/zju/mywork/PromptAD/datasets/visa.py", line 51, in load_visa
    train_tot_types = load_phase(train_img_path, ground_truth_path)
  File "/home/zju/mywork/PromptAD/datasets/visa.py", line 20, in load_phase
    defect_types = os.listdir(root_path)
FileNotFoundError: [Errno 2] No such file or directory: '/data2/grj/pro_visa/1cls/macaroni2/train'
Traceback (most recent call last):
  File "/home/zju/mywork/PromptAD/train_cls.py", line 313, in <module>
    main(args)
  File "/home/zju/mywork/PromptAD/train_cls.py", line 213, in main
    train_dataloader, train_dataset_inst = get_dataloader_from_args(phase='train', perturbed=False, transform=model.transform, **kwargs)
  File "/home/zju/mywork/PromptAD/datasets/__init__.py", line 29, in get_dataloader_from_args
    dataset_inst = CLIPDataset(
  File "/home/zju/mywork/PromptAD/datasets/dataset.py", line 18, in __init__
    self.img_paths, self.gt_paths, self.labels, self.types = self.load_dataset(k_shot)  # self.labels => good : 0, anomaly : 1
  File "/home/zju/mywork/PromptAD/datasets/dataset.py", line 23, in load_dataset
    (test_img_tot_paths, test_gt_tot_paths, test_tot_labels, test_tot_types) = self.load_function(self.category,
  File "/home/zju/mywork/PromptAD/datasets/visa.py", line 51, in load_visa
    train_tot_types = load_phase(train_img_path, ground_truth_path)
  File "/home/zju/mywork/PromptAD/datasets/visa.py", line 20, in load_phase
    defect_types = os.listdir(root_path)
FileNotFoundError: [Errno 2] No such file or directory: '/data2/grj/pro_visa/1cls/macaroni1/train'
/home/zju/miniconda3/envs/prompt_ad/lib/python3.10/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
/home/zju/miniconda3/envs/prompt_ad/lib/python3.10/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
Traceback (most recent call last):
  File "/home/zju/mywork/PromptAD/train_cls.py", line 313, in <module>
    main(args)
  File "/home/zju/mywork/PromptAD/train_cls.py", line 213, in main
    train_dataloader, train_dataset_inst = get_dataloader_from_args(phase='train', perturbed=False, transform=model.transform, **kwargs)
  File "/home/zju/mywork/PromptAD/datasets/__init__.py", line 29, in get_dataloader_from_args
    dataset_inst = CLIPDataset(
  File "/home/zju/mywork/PromptAD/datasets/dataset.py", line 18, in __init__
    self.img_paths, self.gt_paths, self.labels, self.types = self.load_dataset(k_shot)  # self.labels => good : 0, anomaly : 1
  File "/home/zju/mywork/PromptAD/datasets/dataset.py", line 23, in load_dataset
    (test_img_tot_paths, test_gt_tot_paths, test_tot_labels, test_tot_types) = self.load_function(self.category,
  File "/home/zju/mywork/PromptAD/datasets/visa.py", line 51, in load_visa
    train_tot_types = load_phase(train_img_path, ground_truth_path)
  File "/home/zju/mywork/PromptAD/datasets/visa.py", line 20, in load_phase
    defect_types = os.listdir(root_path)
FileNotFoundError: [Errno 2] No such file or directory: '/data2/grj/pro_visa/1cls/pcb1/train'
Traceback (most recent call last):
  File "/home/zju/mywork/PromptAD/train_cls.py", line 313, in <module>
    main(args)
  File "/home/zju/mywork/PromptAD/train_cls.py", line 213, in main
    train_dataloader, train_dataset_inst = get_dataloader_from_args(phase='train', perturbed=False, transform=model.transform, **kwargs)
  File "/home/zju/mywork/PromptAD/datasets/__init__.py", line 29, in get_dataloader_from_args
    dataset_inst = CLIPDataset(
  File "/home/zju/mywork/PromptAD/datasets/dataset.py", line 18, in __init__
    self.img_paths, self.gt_paths, self.labels, self.types = self.load_dataset(k_shot)  # self.labels => good : 0, anomaly : 1
  File "/home/zju/mywork/PromptAD/datasets/dataset.py", line 23, in load_dataset
    (test_img_tot_paths, test_gt_tot_paths, test_tot_labels, test_tot_types) = self.load_function(self.category,
  File "/home/zju/mywork/PromptAD/datasets/visa.py", line 51, in load_visa
    train_tot_types = load_phase(train_img_path, ground_truth_path)
  File "/home/zju/mywork/PromptAD/datasets/visa.py", line 20, in load_phase
    defect_types = os.listdir(root_path)
FileNotFoundError: [Errno 2] No such file or directory: '/data2/grj/pro_visa/1cls/pcb2/train'
/home/zju/miniconda3/envs/prompt_ad/lib/python3.10/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
/home/zju/miniconda3/envs/prompt_ad/lib/python3.10/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
Traceback (most recent call last):
  File "/home/zju/mywork/PromptAD/train_cls.py", line 313, in <module>
    main(args)
  File "/home/zju/mywork/PromptAD/train_cls.py", line 213, in main
    train_dataloader, train_dataset_inst = get_dataloader_from_args(phase='train', perturbed=False, transform=model.transform, **kwargs)
  File "/home/zju/mywork/PromptAD/datasets/__init__.py", line 29, in get_dataloader_from_args
    dataset_inst = CLIPDataset(
  File "/home/zju/mywork/PromptAD/datasets/dataset.py", line 18, in __init__
    self.img_paths, self.gt_paths, self.labels, self.types = self.load_dataset(k_shot)  # self.labels => good : 0, anomaly : 1
  File "/home/zju/mywork/PromptAD/datasets/dataset.py", line 23, in load_dataset
    (test_img_tot_paths, test_gt_tot_paths, test_tot_labels, test_tot_types) = self.load_function(self.category,
  File "/home/zju/mywork/PromptAD/datasets/visa.py", line 51, in load_visa
    train_tot_types = load_phase(train_img_path, ground_truth_path)
  File "/home/zju/mywork/PromptAD/datasets/visa.py", line 20, in load_phase
    defect_types = os.listdir(root_path)
FileNotFoundError: [Errno 2] No such file or directory: '/data2/grj/pro_visa/1cls/pcb3/train'
Traceback (most recent call last):
  File "/home/zju/mywork/PromptAD/train_cls.py", line 313, in <module>
    main(args)
  File "/home/zju/mywork/PromptAD/train_cls.py", line 213, in main
    train_dataloader, train_dataset_inst = get_dataloader_from_args(phase='train', perturbed=False, transform=model.transform, **kwargs)
  File "/home/zju/mywork/PromptAD/datasets/__init__.py", line 29, in get_dataloader_from_args
    dataset_inst = CLIPDataset(
  File "/home/zju/mywork/PromptAD/datasets/dataset.py", line 18, in __init__
    self.img_paths, self.gt_paths, self.labels, self.types = self.load_dataset(k_shot)  # self.labels => good : 0, anomaly : 1
  File "/home/zju/mywork/PromptAD/datasets/dataset.py", line 23, in load_dataset
    (test_img_tot_paths, test_gt_tot_paths, test_tot_labels, test_tot_types) = self.load_function(self.category,
  File "/home/zju/mywork/PromptAD/datasets/visa.py", line 51, in load_visa
    train_tot_types = load_phase(train_img_path, ground_truth_path)
  File "/home/zju/mywork/PromptAD/datasets/visa.py", line 20, in load_phase
    defect_types = os.listdir(root_path)
FileNotFoundError: [Errno 2] No such file or directory: '/data2/grj/pro_visa/1cls/pcb4/train'
/home/zju/miniconda3/envs/prompt_ad/lib/python3.10/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
Traceback (most recent call last):
  File "/home/zju/mywork/PromptAD/train_cls.py", line 313, in <module>
    main(args)
  File "/home/zju/mywork/PromptAD/train_cls.py", line 213, in main
    train_dataloader, train_dataset_inst = get_dataloader_from_args(phase='train', perturbed=False, transform=model.transform, **kwargs)
  File "/home/zju/mywork/PromptAD/datasets/__init__.py", line 29, in get_dataloader_from_args
    dataset_inst = CLIPDataset(
  File "/home/zju/mywork/PromptAD/datasets/dataset.py", line 18, in __init__
    self.img_paths, self.gt_paths, self.labels, self.types = self.load_dataset(k_shot)  # self.labels => good : 0, anomaly : 1
  File "/home/zju/mywork/PromptAD/datasets/dataset.py", line 23, in load_dataset
    (test_img_tot_paths, test_gt_tot_paths, test_tot_labels, test_tot_types) = self.load_function(self.category,
  File "/home/zju/mywork/PromptAD/datasets/visa.py", line 51, in load_visa
    train_tot_types = load_phase(train_img_path, ground_truth_path)
  File "/home/zju/mywork/PromptAD/datasets/visa.py", line 20, in load_phase
    defect_types = os.listdir(root_path)
FileNotFoundError: [Errno 2] No such file or directory: '/data2/grj/pro_visa/1cls/pipe_fryum/train'
python train_cls.py --dataset visa --gpu-id 0 --k-shot 4 --class_name pcb2 --root-dir ./result/prompt1
python train_cls.py --dataset visa --gpu-id 0 --k-shot 4 --class_name pcb3 --root-dir ./result/prompt1
python train_cls.py --dataset visa --gpu-id 0 --k-shot 4 --class_name pcb4 --root-dir ./result/prompt1
python train_cls.py --dataset visa --gpu-id 0 --k-shot 4 --class_name pipe_fryum --root-dir ./result/prompt1

================================================================================
主程序终止时间: 2025-12-20 15:38:32
主程序总用时: 0小时 29分钟 10秒
================================================================================


================================================================================
主程序起始时间: 2025-12-20 16:22:09
================================================================================

python train_cls.py --dataset mvtec --gpu-id 1 --k-shot 1 --class_name carpet --root-dir ./result/prompt1 > ./result/prompt1/seg_logs/k1_mvtec_carpet.log 2>&1
python train_cls.py --dataset mvtec --gpu-id 1 --k-shot 1 --class_name grid --root-dir ./result/prompt1 > ./result/prompt1/seg_logs/k1_mvtec_grid.log 2>&1
python train_cls.py --dataset mvtec --gpu-id 1 --k-shot 1 --class_name leather --root-dir ./result/prompt1 > ./result/prompt1/seg_logs/k1_mvtec_leather.log 2>&1
python train_cls.py --dataset mvtec --gpu-id 1 --k-shot 1 --class_name tile --root-dir ./result/prompt1 > ./result/prompt1/seg_logs/k1_mvtec_tile.log 2>&1
python train_cls.py --dataset mvtec --gpu-id 1 --k-shot 1 --class_name wood --root-dir ./result/prompt1 > ./result/prompt1/seg_logs/k1_mvtec_wood.log 2>&1
python train_cls.py --dataset mvtec --gpu-id 1 --k-shot 1 --class_name bottle --root-dir ./result/prompt1 > ./result/prompt1/seg_logs/k1_mvtec_bottle.log 2>&1
python train_cls.py --dataset mvtec --gpu-id 1 --k-shot 1 --class_name cable --root-dir ./result/prompt1 > ./result/prompt1/seg_logs/k1_mvtec_cable.log 2>&1
python train_cls.py --dataset mvtec --gpu-id 1 --k-shot 1 --class_name capsule --root-dir ./result/prompt1 > ./result/prompt1/seg_logs/k1_mvtec_capsule.log 2>&1
python train_cls.py --dataset mvtec --gpu-id 1 --k-shot 1 --class_name hazelnut --root-dir ./result/prompt1 > ./result/prompt1/seg_logs/k1_mvtec_hazelnut.log 2>&1
python train_cls.py --dataset mvtec --gpu-id 1 --k-shot 1 --class_name metal_nut --root-dir ./result/prompt1 > ./result/prompt1/seg_logs/k1_mvtec_metal_nut.log 2>&1
python train_cls.py --dataset mvtec --gpu-id 1 --k-shot 1 --class_name pill --root-dir ./result/prompt1 > ./result/prompt1/seg_logs/k1_mvtec_pill.log 2>&1
python train_cls.py --dataset mvtec --gpu-id 1 --k-shot 1 --class_name screw --root-dir ./result/prompt1 > ./result/prompt1/seg_logs/k1_mvtec_screw.log 2>&1
python train_cls.py --dataset mvtec --gpu-id 1 --k-shot 1 --class_name toothbrush --root-dir ./result/prompt1 > ./result/prompt1/seg_logs/k1_mvtec_toothbrush.log 2>&1
python train_cls.py --dataset mvtec --gpu-id 1 --k-shot 1 --class_name transistor --root-dir ./result/prompt1 > ./result/prompt1/seg_logs/k1_mvtec_transistor.log 2>&1
python train_cls.py --dataset mvtec --gpu-id 1 --k-shot 1 --class_name zipper --root-dir ./result/prompt1 > ./result/prompt1/seg_logs/k1_mvtec_zipper.log 2>&1
python train_cls.py --dataset visa --gpu-id 1 --k-shot 1 --class_name candle --root-dir ./result/prompt1 > ./result/prompt1/seg_logs/k1_visa_candle.log 2>&1
python train_cls.py --dataset visa --gpu-id 1 --k-shot 1 --class_name capsules --root-dir ./result/prompt1 > ./result/prompt1/seg_logs/k1_visa_capsules.log 2>&1
python train_cls.py --dataset visa --gpu-id 1 --k-shot 1 --class_name cashew --root-dir ./result/prompt1 > ./result/prompt1/seg_logs/k1_visa_cashew.log 2>&1
python train_cls.py --dataset visa --gpu-id 1 --k-shot 1 --class_name chewinggum --root-dir ./result/prompt1 > ./result/prompt1/seg_logs/k1_visa_chewinggum.log 2>&1
python train_cls.py --dataset visa --gpu-id 1 --k-shot 1 --class_name fryum --root-dir ./result/prompt1 > ./result/prompt1/seg_logs/k1_visa_fryum.log 2>&1
python train_cls.py --dataset visa --gpu-id 1 --k-shot 1 --class_name macaroni1 --root-dir ./result/prompt1 > ./result/prompt1/seg_logs/k1_visa_macaroni1.log 2>&1
python train_cls.py --dataset visa --gpu-id 1 --k-shot 1 --class_name macaroni2 --root-dir ./result/prompt1 > ./result/prompt1/seg_logs/k1_visa_macaroni2.log 2>&1
python train_cls.py --dataset visa --gpu-id 1 --k-shot 1 --class_name pcb1 --root-dir ./result/prompt1 > ./result/prompt1/seg_logs/k1_visa_pcb1.log 2>&1
python train_cls.py --dataset visa --gpu-id 1 --k-shot 1 --class_name pcb2 --root-dir ./result/prompt1 > ./result/prompt1/seg_logs/k1_visa_pcb2.log 2>&1
python train_cls.py --dataset visa --gpu-id 1 --k-shot 1 --class_name pcb3 --root-dir ./result/prompt1 > ./result/prompt1/seg_logs/k1_visa_pcb3.log 2>&1
python train_cls.py --dataset visa --gpu-id 1 --k-shot 1 --class_name pcb4 --root-dir ./result/prompt1 > ./result/prompt1/seg_logs/k1_visa_pcb4.log 2>&1
python train_cls.py --dataset visa --gpu-id 1 --k-shot 1 --class_name pipe_fryum --root-dir ./result/prompt1 > ./result/prompt1/seg_logs/k1_visa_pipe_fryum.log 2>&1
python train_cls.py --dataset mvtec --gpu-id 1 --k-shot 2 --class_name carpet --root-dir ./result/prompt1 > ./result/prompt1/seg_logs/k2_mvtec_carpet.log 2>&1
python train_cls.py --dataset mvtec --gpu-id 1 --k-shot 2 --class_name grid --root-dir ./result/prompt1 > ./result/prompt1/seg_logs/k2_mvtec_grid.log 2>&1
python train_cls.py --dataset mvtec --gpu-id 1 --k-shot 2 --class_name leather --root-dir ./result/prompt1 > ./result/prompt1/seg_logs/k2_mvtec_leather.log 2>&1
python train_cls.py --dataset mvtec --gpu-id 1 --k-shot 2 --class_name tile --root-dir ./result/prompt1 > ./result/prompt1/seg_logs/k2_mvtec_tile.log 2>&1
python train_cls.py --dataset mvtec --gpu-id 1 --k-shot 2 --class_name wood --root-dir ./result/prompt1 > ./result/prompt1/seg_logs/k2_mvtec_wood.log 2>&1
python train_cls.py --dataset mvtec --gpu-id 1 --k-shot 2 --class_name bottle --root-dir ./result/prompt1 > ./result/prompt1/seg_logs/k2_mvtec_bottle.log 2>&1
python train_cls.py --dataset mvtec --gpu-id 1 --k-shot 2 --class_name cable --root-dir ./result/prompt1 > ./result/prompt1/seg_logs/k2_mvtec_cable.log 2>&1
python train_cls.py --dataset mvtec --gpu-id 1 --k-shot 2 --class_name capsule --root-dir ./result/prompt1 > ./result/prompt1/seg_logs/k2_mvtec_capsule.log 2>&1
python train_cls.py --dataset mvtec --gpu-id 1 --k-shot 2 --class_name hazelnut --root-dir ./result/prompt1 > ./result/prompt1/seg_logs/k2_mvtec_hazelnut.log 2>&1
python train_cls.py --dataset mvtec --gpu-id 1 --k-shot 2 --class_name metal_nut --root-dir ./result/prompt1 > ./result/prompt1/seg_logs/k2_mvtec_metal_nut.log 2>&1
python train_cls.py --dataset mvtec --gpu-id 1 --k-shot 2 --class_name pill --root-dir ./result/prompt1 > ./result/prompt1/seg_logs/k2_mvtec_pill.log 2>&1
python train_cls.py --dataset mvtec --gpu-id 1 --k-shot 2 --class_name screw --root-dir ./result/prompt1 > ./result/prompt1/seg_logs/k2_mvtec_screw.log 2>&1
python train_cls.py --dataset mvtec --gpu-id 1 --k-shot 2 --class_name toothbrush --root-dir ./result/prompt1 > ./result/prompt1/seg_logs/k2_mvtec_toothbrush.log 2>&1
python train_cls.py --dataset mvtec --gpu-id 1 --k-shot 2 --class_name transistor --root-dir ./result/prompt1 > ./result/prompt1/seg_logs/k2_mvtec_transistor.log 2>&1
python train_cls.py --dataset mvtec --gpu-id 1 --k-shot 2 --class_name zipper --root-dir ./result/prompt1 > ./result/prompt1/seg_logs/k2_mvtec_zipper.log 2>&1
python train_cls.py --dataset visa --gpu-id 1 --k-shot 2 --class_name candle --root-dir ./result/prompt1 > ./result/prompt1/seg_logs/k2_visa_candle.log 2>&1
python train_cls.py --dataset visa --gpu-id 1 --k-shot 2 --class_name capsules --root-dir ./result/prompt1 > ./result/prompt1/seg_logs/k2_visa_capsules.log 2>&1
python train_cls.py --dataset visa --gpu-id 1 --k-shot 2 --class_name cashew --root-dir ./result/prompt1 > ./result/prompt1/seg_logs/k2_visa_cashew.log 2>&1
python train_cls.py --dataset visa --gpu-id 1 --k-shot 2 --class_name chewinggum --root-dir ./result/prompt1 > ./result/prompt1/seg_logs/k2_visa_chewinggum.log 2>&1
python train_cls.py --dataset visa --gpu-id 1 --k-shot 2 --class_name fryum --root-dir ./result/prompt1 > ./result/prompt1/seg_logs/k2_visa_fryum.log 2>&1
python train_cls.py --dataset visa --gpu-id 1 --k-shot 2 --class_name macaroni1 --root-dir ./result/prompt1 > ./result/prompt1/seg_logs/k2_visa_macaroni1.log 2>&1
python train_cls.py --dataset visa --gpu-id 1 --k-shot 2 --class_name macaroni2 --root-dir ./result/prompt1 > ./result/prompt1/seg_logs/k2_visa_macaroni2.log 2>&1
python train_cls.py --dataset visa --gpu-id 1 --k-shot 2 --class_name pcb1 --root-dir ./result/prompt1 > ./result/prompt1/seg_logs/k2_visa_pcb1.log 2>&1
python train_cls.py --dataset visa --gpu-id 1 --k-shot 2 --class_name pcb2 --root-dir ./result/prompt1 > ./result/prompt1/seg_logs/k2_visa_pcb2.log 2>&1
python train_cls.py --dataset visa --gpu-id 1 --k-shot 2 --class_name pcb3 --root-dir ./result/prompt1 > ./result/prompt1/seg_logs/k2_visa_pcb3.log 2>&1
python train_cls.py --dataset visa --gpu-id 1 --k-shot 2 --class_name pcb4 --root-dir ./result/prompt1 > ./result/prompt1/seg_logs/k2_visa_pcb4.log 2>&1
python train_cls.py --dataset visa --gpu-id 1 --k-shot 2 --class_name pipe_fryum --root-dir ./result/prompt1 > ./result/prompt1/seg_logs/k2_visa_pipe_fryum.log 2>&1
python train_cls.py --dataset mvtec --gpu-id 1 --k-shot 4 --class_name carpet --root-dir ./result/prompt1 > ./result/prompt1/seg_logs/k4_mvtec_carpet.log 2>&1
python train_cls.py --dataset mvtec --gpu-id 1 --k-shot 4 --class_name grid --root-dir ./result/prompt1 > ./result/prompt1/seg_logs/k4_mvtec_grid.log 2>&1
python train_cls.py --dataset mvtec --gpu-id 1 --k-shot 4 --class_name leather --root-dir ./result/prompt1 > ./result/prompt1/seg_logs/k4_mvtec_leather.log 2>&1
python train_cls.py --dataset mvtec --gpu-id 1 --k-shot 4 --class_name tile --root-dir ./result/prompt1 > ./result/prompt1/seg_logs/k4_mvtec_tile.log 2>&1
python train_cls.py --dataset mvtec --gpu-id 1 --k-shot 4 --class_name wood --root-dir ./result/prompt1 > ./result/prompt1/seg_logs/k4_mvtec_wood.log 2>&1
python train_cls.py --dataset mvtec --gpu-id 1 --k-shot 4 --class_name bottle --root-dir ./result/prompt1 > ./result/prompt1/seg_logs/k4_mvtec_bottle.log 2>&1
python train_cls.py --dataset mvtec --gpu-id 1 --k-shot 4 --class_name cable --root-dir ./result/prompt1 > ./result/prompt1/seg_logs/k4_mvtec_cable.log 2>&1
python train_cls.py --dataset mvtec --gpu-id 1 --k-shot 4 --class_name capsule --root-dir ./result/prompt1 > ./result/prompt1/seg_logs/k4_mvtec_capsule.log 2>&1
python train_cls.py --dataset mvtec --gpu-id 1 --k-shot 4 --class_name hazelnut --root-dir ./result/prompt1 > ./result/prompt1/seg_logs/k4_mvtec_hazelnut.log 2>&1
python train_cls.py --dataset mvtec --gpu-id 1 --k-shot 4 --class_name metal_nut --root-dir ./result/prompt1 > ./result/prompt1/seg_logs/k4_mvtec_metal_nut.log 2>&1
python train_cls.py --dataset mvtec --gpu-id 1 --k-shot 4 --class_name pill --root-dir ./result/prompt1 > ./result/prompt1/seg_logs/k4_mvtec_pill.log 2>&1
python train_cls.py --dataset mvtec --gpu-id 1 --k-shot 4 --class_name screw --root-dir ./result/prompt1 > ./result/prompt1/seg_logs/k4_mvtec_screw.log 2>&1
python train_cls.py --dataset mvtec --gpu-id 1 --k-shot 4 --class_name toothbrush --root-dir ./result/prompt1 > ./result/prompt1/seg_logs/k4_mvtec_toothbrush.log 2>&1
python train_cls.py --dataset mvtec --gpu-id 1 --k-shot 4 --class_name transistor --root-dir ./result/prompt1 > ./result/prompt1/seg_logs/k4_mvtec_transistor.log 2>&1
python train_cls.py --dataset mvtec --gpu-id 1 --k-shot 4 --class_name zipper --root-dir ./result/prompt1 > ./result/prompt1/seg_logs/k4_mvtec_zipper.log 2>&1
python train_cls.py --dataset visa --gpu-id 1 --k-shot 4 --class_name candle --root-dir ./result/prompt1 > ./result/prompt1/seg_logs/k4_visa_candle.log 2>&1
python train_cls.py --dataset visa --gpu-id 1 --k-shot 4 --class_name capsules --root-dir ./result/prompt1 > ./result/prompt1/seg_logs/k4_visa_capsules.log 2>&1
python train_cls.py --dataset visa --gpu-id 1 --k-shot 4 --class_name cashew --root-dir ./result/prompt1 > ./result/prompt1/seg_logs/k4_visa_cashew.log 2>&1
python train_cls.py --dataset visa --gpu-id 1 --k-shot 4 --class_name chewinggum --root-dir ./result/prompt1 > ./result/prompt1/seg_logs/k4_visa_chewinggum.log 2>&1
python train_cls.py --dataset visa --gpu-id 1 --k-shot 4 --class_name fryum --root-dir ./result/prompt1 > ./result/prompt1/seg_logs/k4_visa_fryum.log 2>&1
python train_cls.py --dataset visa --gpu-id 1 --k-shot 4 --class_name macaroni1 --root-dir ./result/prompt1 > ./result/prompt1/seg_logs/k4_visa_macaroni1.log 2>&1
python train_cls.py --dataset visa --gpu-id 1 --k-shot 4 --class_name macaroni2 --root-dir ./result/prompt1 > ./result/prompt1/seg_logs/k4_visa_macaroni2.log 2>&1
python train_cls.py --dataset visa --gpu-id 1 --k-shot 4 --class_name pcb1 --root-dir ./result/prompt1 > ./result/prompt1/seg_logs/k4_visa_pcb1.log 2>&1
python train_cls.py --dataset visa --gpu-id 1 --k-shot 4 --class_name pcb2 --root-dir ./result/prompt1 > ./result/prompt1/seg_logs/k4_visa_pcb2.log 2>&1
python train_cls.py --dataset visa --gpu-id 1 --k-shot 4 --class_name pcb3 --root-dir ./result/prompt1 > ./result/prompt1/seg_logs/k4_visa_pcb3.log 2>&1
python train_cls.py --dataset visa --gpu-id 1 --k-shot 4 --class_name pcb4 --root-dir ./result/prompt1 > ./result/prompt1/seg_logs/k4_visa_pcb4.log 2>&1
python train_cls.py --dataset visa --gpu-id 1 --k-shot 4 --class_name pipe_fryum --root-dir ./result/prompt1 > ./result/prompt1/seg_logs/k4_visa_pipe_fryum.log 2>&1

================================================================================
主程序终止时间: 2025-12-20 16:25:40
主程序总用时: 0小时 3分钟 31秒
================================================================================


================================================================================
主程序起始时间: 2025-12-20 17:42:13
================================================================================

python train_cls.py --dataset mvtec --gpu-id 0 --k-shot 1 --class_name carpet --root-dir ./result/prompt1
python train_cls.py --dataset mvtec --gpu-id 0 --k-shot 1 --class_name grid --root-dir ./result/prompt1
python train_cls.py --dataset mvtec --gpu-id 0 --k-shot 1 --class_name leather --root-dir ./result/prompt1
python train_cls.py --dataset mvtec --gpu-id 0 --k-shot 1 --class_name tile --root-dir ./result/prompt1
python train_cls.py --dataset mvtec --gpu-id 0 --k-shot 1 --class_name wood --root-dir ./result/prompt1
python train_cls.py --dataset mvtec --gpu-id 0 --k-shot 1 --class_name bottle --root-dir ./result/prompt1
python train_cls.py --dataset mvtec --gpu-id 0 --k-shot 1 --class_name cable --root-dir ./result/prompt1
python train_cls.py --dataset mvtec --gpu-id 0 --k-shot 1 --class_name capsule --root-dir ./result/prompt1
python train_cls.py --dataset mvtec --gpu-id 0 --k-shot 1 --class_name hazelnut --root-dir ./result/prompt1
python train_cls.py --dataset mvtec --gpu-id 0 --k-shot 1 --class_name metal_nut --root-dir ./result/prompt1
python train_cls.py --dataset mvtec --gpu-id 0 --k-shot 1 --class_name pill --root-dir ./result/prompt1
python train_cls.py --dataset mvtec --gpu-id 0 --k-shot 1 --class_name screw --root-dir ./result/prompt1
python train_cls.py --dataset mvtec --gpu-id 0 --k-shot 1 --class_name toothbrush --root-dir ./result/prompt1
python train_cls.py --dataset mvtec --gpu-id 0 --k-shot 1 --class_name transistor --root-dir ./result/prompt1
python train_cls.py --dataset mvtec --gpu-id 0 --k-shot 1 --class_name zipper --root-dir ./result/prompt1
python train_cls.py --dataset visa --gpu-id 0 --k-shot 1 --class_name candle --root-dir ./result/prompt1
python train_cls.py --dataset visa --gpu-id 0 --k-shot 1 --class_name capsules --root-dir ./result/prompt1
python train_cls.py --dataset visa --gpu-id 0 --k-shot 1 --class_name cashew --root-dir ./result/prompt1
python train_cls.py --dataset visa --gpu-id 0 --k-shot 1 --class_name chewinggum --root-dir ./result/prompt1
python train_cls.py --dataset visa --gpu-id 0 --k-shot 1 --class_name fryum --root-dir ./result/prompt1
python train_cls.py --dataset visa --gpu-id 0 --k-shot 1 --class_name macaroni1 --root-dir ./result/prompt1
python train_cls.py --dataset visa --gpu-id 0 --k-shot 1 --class_name macaroni2 --root-dir ./result/prompt1
python train_cls.py --dataset visa --gpu-id 0 --k-shot 1 --class_name pcb1 --root-dir ./result/prompt1
python train_cls.py --dataset visa --gpu-id 0 --k-shot 1 --class_name pcb2 --root-dir ./result/prompt1
python train_cls.py --dataset visa --gpu-id 0 --k-shot 1 --class_name pcb3 --root-dir ./result/prompt1
python train_cls.py --dataset visa --gpu-id 0 --k-shot 1 --class_name pcb4 --root-dir ./result/prompt1
python train_cls.py --dataset visa --gpu-id 0 --k-shot 1 --class_name pipe_fryum --root-dir ./result/prompt1
python train_cls.py --dataset mvtec --gpu-id 0 --k-shot 2 --class_name carpet --root-dir ./result/prompt1
python train_cls.py --dataset mvtec --gpu-id 0 --k-shot 2 --class_name grid --root-dir ./result/prompt1
python train_cls.py --dataset mvtec --gpu-id 0 --k-shot 2 --class_name leather --root-dir ./result/prompt1
python train_cls.py --dataset mvtec --gpu-id 0 --k-shot 2 --class_name tile --root-dir ./result/prompt1
python train_cls.py --dataset mvtec --gpu-id 0 --k-shot 2 --class_name wood --root-dir ./result/prompt1
python train_cls.py --dataset mvtec --gpu-id 0 --k-shot 2 --class_name bottle --root-dir ./result/prompt1
python train_cls.py --dataset mvtec --gpu-id 0 --k-shot 2 --class_name cable --root-dir ./result/prompt1
python train_cls.py --dataset mvtec --gpu-id 0 --k-shot 2 --class_name capsule --root-dir ./result/prompt1
python train_cls.py --dataset mvtec --gpu-id 0 --k-shot 2 --class_name hazelnut --root-dir ./result/prompt1
python train_cls.py --dataset mvtec --gpu-id 0 --k-shot 2 --class_name metal_nut --root-dir ./result/prompt1
python train_cls.py --dataset mvtec --gpu-id 0 --k-shot 2 --class_name pill --root-dir ./result/prompt1
python train_cls.py --dataset mvtec --gpu-id 0 --k-shot 2 --class_name screw --root-dir ./result/prompt1
python train_cls.py --dataset mvtec --gpu-id 0 --k-shot 2 --class_name toothbrush --root-dir ./result/prompt1
python train_cls.py --dataset mvtec --gpu-id 0 --k-shot 2 --class_name transistor --root-dir ./result/prompt1
python train_cls.py --dataset mvtec --gpu-id 0 --k-shot 2 --class_name zipper --root-dir ./result/prompt1
python train_cls.py --dataset visa --gpu-id 0 --k-shot 2 --class_name candle --root-dir ./result/prompt1
python train_cls.py --dataset visa --gpu-id 0 --k-shot 2 --class_name capsules --root-dir ./result/prompt1
python train_cls.py --dataset visa --gpu-id 0 --k-shot 2 --class_name cashew --root-dir ./result/prompt1
python train_cls.py --dataset visa --gpu-id 0 --k-shot 2 --class_name chewinggum --root-dir ./result/prompt1
python train_cls.py --dataset visa --gpu-id 0 --k-shot 2 --class_name fryum --root-dir ./result/prompt1
python train_cls.py --dataset visa --gpu-id 0 --k-shot 2 --class_name macaroni1 --root-dir ./result/prompt1
python train_cls.py --dataset visa --gpu-id 0 --k-shot 2 --class_name macaroni2 --root-dir ./result/prompt1
python train_cls.py --dataset visa --gpu-id 0 --k-shot 2 --class_name pcb1 --root-dir ./result/prompt1
python train_cls.py --dataset visa --gpu-id 0 --k-shot 2 --class_name pcb2 --root-dir ./result/prompt1
python train_cls.py --dataset visa --gpu-id 0 --k-shot 2 --class_name pcb3 --root-dir ./result/prompt1
python train_cls.py --dataset visa --gpu-id 0 --k-shot 2 --class_name pcb4 --root-dir ./result/prompt1
python train_cls.py --dataset visa --gpu-id 0 --k-shot 2 --class_name pipe_fryum --root-dir ./result/prompt1
python train_cls.py --dataset mvtec --gpu-id 0 --k-shot 4 --class_name carpet --root-dir ./result/prompt1
python train_cls.py --dataset mvtec --gpu-id 0 --k-shot 4 --class_name grid --root-dir ./result/prompt1
python train_cls.py --dataset mvtec --gpu-id 0 --k-shot 4 --class_name leather --root-dir ./result/prompt1
python train_cls.py --dataset mvtec --gpu-id 0 --k-shot 4 --class_name tile --root-dir ./result/prompt1
python train_cls.py --dataset mvtec --gpu-id 0 --k-shot 4 --class_name wood --root-dir ./result/prompt1
python train_cls.py --dataset mvtec --gpu-id 0 --k-shot 4 --class_name bottle --root-dir ./result/prompt1
python train_cls.py --dataset mvtec --gpu-id 0 --k-shot 4 --class_name cable --root-dir ./result/prompt1
python train_cls.py --dataset mvtec --gpu-id 0 --k-shot 4 --class_name capsule --root-dir ./result/prompt1
python train_cls.py --dataset mvtec --gpu-id 0 --k-shot 4 --class_name hazelnut --root-dir ./result/prompt1
python train_cls.py --dataset mvtec --gpu-id 0 --k-shot 4 --class_name metal_nut --root-dir ./result/prompt1
python train_cls.py --dataset mvtec --gpu-id 0 --k-shot 4 --class_name pill --root-dir ./result/prompt1
python train_cls.py --dataset mvtec --gpu-id 0 --k-shot 4 --class_name screw --root-dir ./result/prompt1
python train_cls.py --dataset mvtec --gpu-id 0 --k-shot 4 --class_name toothbrush --root-dir ./result/prompt1
python train_cls.py --dataset mvtec --gpu-id 0 --k-shot 4 --class_name transistor --root-dir ./result/prompt1
python train_cls.py --dataset mvtec --gpu-id 0 --k-shot 4 --class_name zipper --root-dir ./result/prompt1
python train_cls.py --dataset visa --gpu-id 0 --k-shot 4 --class_name candle --root-dir ./result/prompt1
python train_cls.py --dataset visa --gpu-id 0 --k-shot 4 --class_name capsules --root-dir ./result/prompt1
python train_cls.py --dataset visa --gpu-id 0 --k-shot 4 --class_name cashew --root-dir ./result/prompt1
python train_cls.py --dataset visa --gpu-id 0 --k-shot 4 --class_name chewinggum --root-dir ./result/prompt1
python train_cls.py --dataset visa --gpu-id 0 --k-shot 4 --class_name fryum --root-dir ./result/prompt1
python train_cls.py --dataset visa --gpu-id 0 --k-shot 4 --class_name macaroni1 --root-dir ./result/prompt1
python train_cls.py --dataset visa --gpu-id 0 --k-shot 4 --class_name macaroni2 --root-dir ./result/prompt1
python train_cls.py --dataset visa --gpu-id 0 --k-shot 4 --class_name pcb1 --root-dir ./result/prompt1
/home/zju/miniconda3/envs/prompt_ad/lib/python3.10/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
/home/zju/miniconda3/envs/prompt_ad/lib/python3.10/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
python train_cls.py --dataset visa --gpu-id 0 --k-shot 4 --class_name pcb2 --root-dir ./result/prompt1
python train_cls.py --dataset visa --gpu-id 0 --k-shot 4 --class_name pcb3 --root-dir ./result/prompt1
python train_cls.py --dataset visa --gpu-id 0 --k-shot 4 --class_name pcb4 --root-dir ./result/prompt1
python train_cls.py --dataset visa --gpu-id 0 --k-shot 4 --class_name pipe_fryum --root-dir ./result/prompt1
Traceback (most recent call last):
  File "/home/zju/mywork/PromptAD/run_cls.py", line 54, in <module>
    pool.join()
  File "/home/zju/miniconda3/envs/prompt_ad/lib/python3.10/multiprocessing/pool.py", line 662, in join
    self._worker_handler.join()
  File "/home/zju/miniconda3/envs/prompt_ad/lib/python3.10/threading.py", line 1089, in join
    self._wait_for_tstate_lock()
  File "/home/zju/miniconda3/envs/prompt_ad/lib/python3.10/threading.py", line 1105, in _wait_for_tstate_lock
    elif lock.acquire(block, timeout):
KeyboardInterrupt
Traceback (most recent call last):
  File "/home/zju/mywork/PromptAD/train_cls.py", line 313, in <module>
    main(args)
  File "/home/zju/mywork/PromptAD/train_cls.py", line 219, in main
    metrics = fit(model, args, test_dataloader, device, check_path=check_path, train_data=train_dataloader)
  File "/home/zju/mywork/PromptAD/train_cls.py", line 126, in fit
    for (data, mask, label, name, img_type) in dataloader:
  File "/home/zju/miniconda3/envs/prompt_ad/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 631, in __next__
    data = self._next_data()
  File "/home/zju/miniconda3/envs/prompt_ad/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 675, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
  File "/home/zju/miniconda3/envs/prompt_ad/lib/python3.10/site-packages/torch/utils/data/_utils/fetch.py", line 51, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/zju/miniconda3/envs/prompt_ad/lib/python3.10/site-packages/torch/utils/data/_utils/fetch.py", line 51, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/zju/mywork/PromptAD/datasets/dataset.py", line 39, in __getitem__
    img = cv2.imread(img_path, cv2.IMREAD_COLOR)
KeyboardInterrupt
Traceback (most recent call last):
  File "/home/zju/mywork/PromptAD/train_cls.py", line 313, in <module>
    main(args)
  File "/home/zju/mywork/PromptAD/train_cls.py", line 219, in main
    metrics = fit(model, args, test_dataloader, device, check_path=check_path, train_data=train_dataloader)
  File "/home/zju/mywork/PromptAD/train_cls.py", line 110, in fit
    loss.backward()
  File "/home/zju/miniconda3/envs/prompt_ad/lib/python3.10/site-packages/torch/_tensor.py", line 522, in backward
    torch.autograd.backward(
  File "/home/zju/miniconda3/envs/prompt_ad/lib/python3.10/site-packages/torch/autograd/__init__.py", line 266, in backward
    Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
KeyboardInterrupt

================================================================================
主程序起始时间: 2025-12-20 17:42:37
================================================================================

python train_cls.py --dataset mvtec --gpu-id 0 --k-shot 1 --class_name carpet --root-dir ./result/prompt1
python train_cls.py --dataset mvtec --gpu-id 0 --k-shot 1 --class_name grid --root-dir ./result/prompt1
python train_cls.py --dataset mvtec --gpu-id 0 --k-shot 1 --class_name leather --root-dir ./result/prompt1
python train_cls.py --dataset mvtec --gpu-id 0 --k-shot 1 --class_name tile --root-dir ./result/prompt1
python train_cls.py --dataset mvtec --gpu-id 0 --k-shot 1 --class_name wood --root-dir ./result/prompt1
python train_cls.py --dataset mvtec --gpu-id 0 --k-shot 1 --class_name bottle --root-dir ./result/prompt1
python train_cls.py --dataset mvtec --gpu-id 0 --k-shot 1 --class_name cable --root-dir ./result/prompt1
python train_cls.py --dataset mvtec --gpu-id 0 --k-shot 1 --class_name capsule --root-dir ./result/prompt1
python train_cls.py --dataset mvtec --gpu-id 0 --k-shot 1 --class_name hazelnut --root-dir ./result/prompt1
python train_cls.py --dataset mvtec --gpu-id 0 --k-shot 1 --class_name metal_nut --root-dir ./result/prompt1
python train_cls.py --dataset mvtec --gpu-id 0 --k-shot 1 --class_name pill --root-dir ./result/prompt1
python train_cls.py --dataset mvtec --gpu-id 0 --k-shot 1 --class_name screw --root-dir ./result/prompt1
python train_cls.py --dataset mvtec --gpu-id 0 --k-shot 1 --class_name toothbrush --root-dir ./result/prompt1
python train_cls.py --dataset mvtec --gpu-id 0 --k-shot 1 --class_name transistor --root-dir ./result/prompt1
python train_cls.py --dataset mvtec --gpu-id 0 --k-shot 1 --class_name zipper --root-dir ./result/prompt1
python train_cls.py --dataset visa --gpu-id 0 --k-shot 1 --class_name candle --root-dir ./result/prompt1
python train_cls.py --dataset visa --gpu-id 0 --k-shot 1 --class_name capsules --root-dir ./result/prompt1
python train_cls.py --dataset visa --gpu-id 0 --k-shot 1 --class_name cashew --root-dir ./result/prompt1
python train_cls.py --dataset visa --gpu-id 0 --k-shot 1 --class_name chewinggum --root-dir ./result/prompt1
python train_cls.py --dataset visa --gpu-id 0 --k-shot 1 --class_name fryum --root-dir ./result/prompt1
python train_cls.py --dataset visa --gpu-id 0 --k-shot 1 --class_name macaroni1 --root-dir ./result/prompt1
python train_cls.py --dataset visa --gpu-id 0 --k-shot 1 --class_name macaroni2 --root-dir ./result/prompt1
python train_cls.py --dataset visa --gpu-id 0 --k-shot 1 --class_name pcb1 --root-dir ./result/prompt1
python train_cls.py --dataset visa --gpu-id 0 --k-shot 1 --class_name pcb2 --root-dir ./result/prompt1
python train_cls.py --dataset visa --gpu-id 0 --k-shot 1 --class_name pcb3 --root-dir ./result/prompt1
python train_cls.py --dataset visa --gpu-id 0 --k-shot 1 --class_name pcb4 --root-dir ./result/prompt1
python train_cls.py --dataset visa --gpu-id 0 --k-shot 1 --class_name pipe_fryum --root-dir ./result/prompt1
python train_cls.py --dataset mvtec --gpu-id 0 --k-shot 2 --class_name carpet --root-dir ./result/prompt1
python train_cls.py --dataset mvtec --gpu-id 0 --k-shot 2 --class_name grid --root-dir ./result/prompt1
python train_cls.py --dataset mvtec --gpu-id 0 --k-shot 2 --class_name leather --root-dir ./result/prompt1
python train_cls.py --dataset mvtec --gpu-id 0 --k-shot 2 --class_name tile --root-dir ./result/prompt1
python train_cls.py --dataset mvtec --gpu-id 0 --k-shot 2 --class_name wood --root-dir ./result/prompt1
python train_cls.py --dataset mvtec --gpu-id 0 --k-shot 2 --class_name bottle --root-dir ./result/prompt1
python train_cls.py --dataset mvtec --gpu-id 0 --k-shot 2 --class_name cable --root-dir ./result/prompt1
python train_cls.py --dataset mvtec --gpu-id 0 --k-shot 2 --class_name capsule --root-dir ./result/prompt1
python train_cls.py --dataset mvtec --gpu-id 0 --k-shot 2 --class_name hazelnut --root-dir ./result/prompt1
python train_cls.py --dataset mvtec --gpu-id 0 --k-shot 2 --class_name metal_nut --root-dir ./result/prompt1
python train_cls.py --dataset mvtec --gpu-id 0 --k-shot 2 --class_name pill --root-dir ./result/prompt1
python train_cls.py --dataset mvtec --gpu-id 0 --k-shot 2 --class_name screw --root-dir ./result/prompt1
python train_cls.py --dataset mvtec --gpu-id 0 --k-shot 2 --class_name toothbrush --root-dir ./result/prompt1
python train_cls.py --dataset mvtec --gpu-id 0 --k-shot 2 --class_name transistor --root-dir ./result/prompt1
python train_cls.py --dataset mvtec --gpu-id 0 --k-shot 2 --class_name zipper --root-dir ./result/prompt1
python train_cls.py --dataset visa --gpu-id 0 --k-shot 2 --class_name candle --root-dir ./result/prompt1
python train_cls.py --dataset visa --gpu-id 0 --k-shot 2 --class_name capsules --root-dir ./result/prompt1
python train_cls.py --dataset visa --gpu-id 0 --k-shot 2 --class_name cashew --root-dir ./result/prompt1
python train_cls.py --dataset visa --gpu-id 0 --k-shot 2 --class_name chewinggum --root-dir ./result/prompt1
python train_cls.py --dataset visa --gpu-id 0 --k-shot 2 --class_name fryum --root-dir ./result/prompt1
python train_cls.py --dataset visa --gpu-id 0 --k-shot 2 --class_name macaroni1 --root-dir ./result/prompt1
python train_cls.py --dataset visa --gpu-id 0 --k-shot 2 --class_name macaroni2 --root-dir ./result/prompt1
python train_cls.py --dataset visa --gpu-id 0 --k-shot 2 --class_name pcb1 --root-dir ./result/prompt1
python train_cls.py --dataset visa --gpu-id 0 --k-shot 2 --class_name pcb2 --root-dir ./result/prompt1
python train_cls.py --dataset visa --gpu-id 0 --k-shot 2 --class_name pcb3 --root-dir ./result/prompt1
python train_cls.py --dataset visa --gpu-id 0 --k-shot 2 --class_name pcb4 --root-dir ./result/prompt1
python train_cls.py --dataset visa --gpu-id 0 --k-shot 2 --class_name pipe_fryum --root-dir ./result/prompt1
python train_cls.py --dataset mvtec --gpu-id 0 --k-shot 4 --class_name carpet --root-dir ./result/prompt1
python train_cls.py --dataset mvtec --gpu-id 0 --k-shot 4 --class_name grid --root-dir ./result/prompt1
python train_cls.py --dataset mvtec --gpu-id 0 --k-shot 4 --class_name leather --root-dir ./result/prompt1
python train_cls.py --dataset mvtec --gpu-id 0 --k-shot 4 --class_name tile --root-dir ./result/prompt1
python train_cls.py --dataset mvtec --gpu-id 0 --k-shot 4 --class_name wood --root-dir ./result/prompt1
python train_cls.py --dataset mvtec --gpu-id 0 --k-shot 4 --class_name bottle --root-dir ./result/prompt1
python train_cls.py --dataset mvtec --gpu-id 0 --k-shot 4 --class_name cable --root-dir ./result/prompt1
python train_cls.py --dataset mvtec --gpu-id 0 --k-shot 4 --class_name capsule --root-dir ./result/prompt1
python train_cls.py --dataset mvtec --gpu-id 0 --k-shot 4 --class_name hazelnut --root-dir ./result/prompt1
python train_cls.py --dataset mvtec --gpu-id 0 --k-shot 4 --class_name metal_nut --root-dir ./result/prompt1
python train_cls.py --dataset mvtec --gpu-id 0 --k-shot 4 --class_name pill --root-dir ./result/prompt1
python train_cls.py --dataset mvtec --gpu-id 0 --k-shot 4 --class_name screw --root-dir ./result/prompt1
python train_cls.py --dataset mvtec --gpu-id 0 --k-shot 4 --class_name toothbrush --root-dir ./result/prompt1
python train_cls.py --dataset mvtec --gpu-id 0 --k-shot 4 --class_name transistor --root-dir ./result/prompt1
python train_cls.py --dataset mvtec --gpu-id 0 --k-shot 4 --class_name zipper --root-dir ./result/prompt1
python train_cls.py --dataset visa --gpu-id 0 --k-shot 4 --class_name candle --root-dir ./result/prompt1
python train_cls.py --dataset visa --gpu-id 0 --k-shot 4 --class_name capsules --root-dir ./result/prompt1
python train_cls.py --dataset visa --gpu-id 0 --k-shot 4 --class_name cashew --root-dir ./result/prompt1
python train_cls.py --dataset visa --gpu-id 0 --k-shot 4 --class_name chewinggum --root-dir ./result/prompt1
python train_cls.py --dataset visa --gpu-id 0 --k-shot 4 --class_name fryum --root-dir ./result/prompt1
python train_cls.py --dataset visa --gpu-id 0 --k-shot 4 --class_name macaroni1 --root-dir ./result/prompt1
python train_cls.py --dataset visa --gpu-id 0 --k-shot 4 --class_name macaroni2 --root-dir ./result/prompt1
python train_cls.py --dataset visa --gpu-id 0 --k-shot 4 --class_name pcb1 --root-dir ./result/prompt1
/home/zju/miniconda3/envs/prompt_ad/lib/python3.10/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
/home/zju/miniconda3/envs/prompt_ad/lib/python3.10/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)

================================================================================
Object:grid =========================== Image-AUROC:99.67
进程起始时间: 2025-12-20 17:42:39
进程终止时间: 2025-12-20 17:43:16
进程用时: 0小时 0分钟 36秒
================================================================================

/home/zju/miniconda3/envs/prompt_ad/lib/python3.10/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)

================================================================================
Object:carpet =========================== Image-AUROC:100.0
进程起始时间: 2025-12-20 17:42:39
进程终止时间: 2025-12-20 17:44:09
进程用时: 0小时 1分钟 29秒
================================================================================

/home/zju/miniconda3/envs/prompt_ad/lib/python3.10/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)

================================================================================
Object:leather =========================== Image-AUROC:100.0
进程起始时间: 2025-12-20 17:43:19
进程终止时间: 2025-12-20 17:44:44
进程用时: 0小时 1分钟 24秒
================================================================================

/home/zju/miniconda3/envs/prompt_ad/lib/python3.10/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)

================================================================================
Object:tile =========================== Image-AUROC:100.0
进程起始时间: 2025-12-20 17:44:11
进程终止时间: 2025-12-20 17:45:20
进程用时: 0小时 1分钟 8秒
================================================================================

/home/zju/miniconda3/envs/prompt_ad/lib/python3.10/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)

================================================================================
Object:wood =========================== Image-AUROC:99.65
进程起始时间: 2025-12-20 17:44:46
进程终止时间: 2025-12-20 17:45:54
进程用时: 0小时 1分钟 7秒
================================================================================

/home/zju/miniconda3/envs/prompt_ad/lib/python3.10/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)

================================================================================
Object:bottle =========================== Image-AUROC:98.57
进程起始时间: 2025-12-20 17:45:22
进程终止时间: 2025-12-20 17:46:05
进程用时: 0小时 0分钟 42秒
================================================================================

/home/zju/miniconda3/envs/prompt_ad/lib/python3.10/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)

================================================================================
Object:capsule =========================== Image-AUROC:77.26
进程起始时间: 2025-12-20 17:46:07
进程终止时间: 2025-12-20 17:47:39
进程用时: 0小时 1分钟 31秒
================================================================================


================================================================================
Object:cable =========================== Image-AUROC:80.66
进程起始时间: 2025-12-20 17:45:56
进程终止时间: 2025-12-20 17:47:41
进程用时: 0小时 1分钟 44秒
================================================================================

/home/zju/miniconda3/envs/prompt_ad/lib/python3.10/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
/home/zju/miniconda3/envs/prompt_ad/lib/python3.10/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)

================================================================================
Object:metal_nut =========================== Image-AUROC:94.77
进程起始时间: 2025-12-20 17:47:44
进程终止时间: 2025-12-20 17:48:31
进程用时: 0小时 0分钟 47秒
================================================================================

/home/zju/miniconda3/envs/prompt_ad/lib/python3.10/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)

================================================================================
Object:hazelnut =========================== Image-AUROC:96.21
进程起始时间: 2025-12-20 17:47:42
进程终止时间: 2025-12-20 17:48:59
进程用时: 0小时 1分钟 17秒
================================================================================

/home/zju/miniconda3/envs/prompt_ad/lib/python3.10/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)

================================================================================
Object:pill =========================== Image-AUROC:84.02
进程起始时间: 2025-12-20 17:48:34
进程终止时间: 2025-12-20 17:49:52
进程用时: 0小时 1分钟 18秒
================================================================================

/home/zju/miniconda3/envs/prompt_ad/lib/python3.10/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)

================================================================================
Object:screw =========================== Image-AUROC:61.59
进程起始时间: 2025-12-20 17:49:02
进程终止时间: 2025-12-20 17:50:01
进程用时: 0小时 0分钟 58秒
================================================================================

/home/zju/miniconda3/envs/prompt_ad/lib/python3.10/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)

================================================================================
Object:toothbrush =========================== Image-AUROC:83.33
进程起始时间: 2025-12-20 17:49:55
进程终止时间: 2025-12-20 17:50:32
进程用时: 0小时 0分钟 37秒
================================================================================

/home/zju/miniconda3/envs/prompt_ad/lib/python3.10/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)

================================================================================
Object:transistor =========================== Image-AUROC:85.79
进程起始时间: 2025-12-20 17:50:03
进程终止时间: 2025-12-20 17:51:19
进程用时: 0小时 1分钟 15秒
================================================================================

/home/zju/miniconda3/envs/prompt_ad/lib/python3.10/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
Traceback (most recent call last):
  File "/home/zju/mywork/PromptAD/train_cls.py", line 313, in <module>
    main(args)
  File "/home/zju/mywork/PromptAD/train_cls.py", line 213, in main
    train_dataloader, train_dataset_inst = get_dataloader_from_args(phase='train', perturbed=False, transform=model.transform, **kwargs)
  File "/home/zju/mywork/PromptAD/datasets/__init__.py", line 29, in get_dataloader_from_args
    dataset_inst = CLIPDataset(
  File "/home/zju/mywork/PromptAD/datasets/dataset.py", line 18, in __init__
    self.img_paths, self.gt_paths, self.labels, self.types = self.load_dataset(k_shot)  # self.labels => good : 0, anomaly : 1
  File "/home/zju/mywork/PromptAD/datasets/dataset.py", line 23, in load_dataset
    (test_img_tot_paths, test_gt_tot_paths, test_tot_labels, test_tot_types) = self.load_function(self.category,
  File "/home/zju/mywork/PromptAD/datasets/visa.py", line 51, in load_visa
    train_tot_types = load_phase(train_img_path, ground_truth_path)
  File "/home/zju/mywork/PromptAD/datasets/visa.py", line 20, in load_phase
    defect_types = os.listdir(root_path)
FileNotFoundError: [Errno 2] No such file or directory: '/data2/grj/pro_visa/1cls/candle/train'
/home/zju/miniconda3/envs/prompt_ad/lib/python3.10/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
Traceback (most recent call last):
  File "/home/zju/mywork/PromptAD/train_cls.py", line 313, in <module>
    main(args)
  File "/home/zju/mywork/PromptAD/train_cls.py", line 213, in main
    train_dataloader, train_dataset_inst = get_dataloader_from_args(phase='train', perturbed=False, transform=model.transform, **kwargs)
  File "/home/zju/mywork/PromptAD/datasets/__init__.py", line 29, in get_dataloader_from_args
    dataset_inst = CLIPDataset(
  File "/home/zju/mywork/PromptAD/datasets/dataset.py", line 18, in __init__
    self.img_paths, self.gt_paths, self.labels, self.types = self.load_dataset(k_shot)  # self.labels => good : 0, anomaly : 1
  File "/home/zju/mywork/PromptAD/datasets/dataset.py", line 23, in load_dataset
    (test_img_tot_paths, test_gt_tot_paths, test_tot_labels, test_tot_types) = self.load_function(self.category,
  File "/home/zju/mywork/PromptAD/datasets/visa.py", line 51, in load_visa
    train_tot_types = load_phase(train_img_path, ground_truth_path)
  File "/home/zju/mywork/PromptAD/datasets/visa.py", line 20, in load_phase
    defect_types = os.listdir(root_path)
FileNotFoundError: [Errno 2] No such file or directory: '/data2/grj/pro_visa/1cls/capsules/train'

================================================================================
Object:zipper =========================== Image-AUROC:94.3
进程起始时间: 2025-12-20 17:50:35
进程终止时间: 2025-12-20 17:51:30
进程用时: 0小时 0分钟 55秒
================================================================================

/home/zju/miniconda3/envs/prompt_ad/lib/python3.10/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
/home/zju/miniconda3/envs/prompt_ad/lib/python3.10/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
Traceback (most recent call last):
  File "/home/zju/mywork/PromptAD/train_cls.py", line 313, in <module>
    main(args)
  File "/home/zju/mywork/PromptAD/train_cls.py", line 213, in main
    train_dataloader, train_dataset_inst = get_dataloader_from_args(phase='train', perturbed=False, transform=model.transform, **kwargs)
  File "/home/zju/mywork/PromptAD/datasets/__init__.py", line 29, in get_dataloader_from_args
    dataset_inst = CLIPDataset(
  File "/home/zju/mywork/PromptAD/datasets/dataset.py", line 18, in __init__
    self.img_paths, self.gt_paths, self.labels, self.types = self.load_dataset(k_shot)  # self.labels => good : 0, anomaly : 1
  File "/home/zju/mywork/PromptAD/datasets/dataset.py", line 23, in load_dataset
    (test_img_tot_paths, test_gt_tot_paths, test_tot_labels, test_tot_types) = self.load_function(self.category,
  File "/home/zju/mywork/PromptAD/datasets/visa.py", line 51, in load_visa
    train_tot_types = load_phase(train_img_path, ground_truth_path)
  File "/home/zju/mywork/PromptAD/datasets/visa.py", line 20, in load_phase
    defect_types = os.listdir(root_path)
FileNotFoundError: [Errno 2] No such file or directory: '/data2/grj/pro_visa/1cls/cashew/train'
Traceback (most recent call last):
  File "/home/zju/mywork/PromptAD/train_cls.py", line 313, in <module>
    main(args)
  File "/home/zju/mywork/PromptAD/train_cls.py", line 213, in main
    train_dataloader, train_dataset_inst = get_dataloader_from_args(phase='train', perturbed=False, transform=model.transform, **kwargs)
  File "/home/zju/mywork/PromptAD/datasets/__init__.py", line 29, in get_dataloader_from_args
    dataset_inst = CLIPDataset(
  File "/home/zju/mywork/PromptAD/datasets/dataset.py", line 18, in __init__
    self.img_paths, self.gt_paths, self.labels, self.types = self.load_dataset(k_shot)  # self.labels => good : 0, anomaly : 1
  File "/home/zju/mywork/PromptAD/datasets/dataset.py", line 23, in load_dataset
    (test_img_tot_paths, test_gt_tot_paths, test_tot_labels, test_tot_types) = self.load_function(self.category,
  File "/home/zju/mywork/PromptAD/datasets/visa.py", line 51, in load_visa
    train_tot_types = load_phase(train_img_path, ground_truth_path)
  File "/home/zju/mywork/PromptAD/datasets/visa.py", line 20, in load_phase
    defect_types = os.listdir(root_path)
FileNotFoundError: [Errno 2] No such file or directory: '/data2/grj/pro_visa/1cls/chewinggum/train'
/home/zju/miniconda3/envs/prompt_ad/lib/python3.10/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
/home/zju/miniconda3/envs/prompt_ad/lib/python3.10/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
Traceback (most recent call last):
  File "/home/zju/mywork/PromptAD/train_cls.py", line 313, in <module>
    main(args)
  File "/home/zju/mywork/PromptAD/train_cls.py", line 213, in main
    train_dataloader, train_dataset_inst = get_dataloader_from_args(phase='train', perturbed=False, transform=model.transform, **kwargs)
  File "/home/zju/mywork/PromptAD/datasets/__init__.py", line 29, in get_dataloader_from_args
    dataset_inst = CLIPDataset(
  File "/home/zju/mywork/PromptAD/datasets/dataset.py", line 18, in __init__
    self.img_paths, self.gt_paths, self.labels, self.types = self.load_dataset(k_shot)  # self.labels => good : 0, anomaly : 1
  File "/home/zju/mywork/PromptAD/datasets/dataset.py", line 23, in load_dataset
    (test_img_tot_paths, test_gt_tot_paths, test_tot_labels, test_tot_types) = self.load_function(self.category,
  File "/home/zju/mywork/PromptAD/datasets/visa.py", line 51, in load_visa
    train_tot_types = load_phase(train_img_path, ground_truth_path)
  File "/home/zju/mywork/PromptAD/datasets/visa.py", line 20, in load_phase
    defect_types = os.listdir(root_path)
FileNotFoundError: [Errno 2] No such file or directory: '/data2/grj/pro_visa/1cls/fryum/train'
Traceback (most recent call last):
  File "/home/zju/mywork/PromptAD/train_cls.py", line 313, in <module>
    main(args)
  File "/home/zju/mywork/PromptAD/train_cls.py", line 213, in main
    train_dataloader, train_dataset_inst = get_dataloader_from_args(phase='train', perturbed=False, transform=model.transform, **kwargs)
  File "/home/zju/mywork/PromptAD/datasets/__init__.py", line 29, in get_dataloader_from_args
    dataset_inst = CLIPDataset(
  File "/home/zju/mywork/PromptAD/datasets/dataset.py", line 18, in __init__
    self.img_paths, self.gt_paths, self.labels, self.types = self.load_dataset(k_shot)  # self.labels => good : 0, anomaly : 1
  File "/home/zju/mywork/PromptAD/datasets/dataset.py", line 23, in load_dataset
    (test_img_tot_paths, test_gt_tot_paths, test_tot_labels, test_tot_types) = self.load_function(self.category,
  File "/home/zju/mywork/PromptAD/datasets/visa.py", line 51, in load_visa
    train_tot_types = load_phase(train_img_path, ground_truth_path)
  File "/home/zju/mywork/PromptAD/datasets/visa.py", line 20, in load_phase
    defect_types = os.listdir(root_path)
FileNotFoundError: [Errno 2] No such file or directory: '/data2/grj/pro_visa/1cls/macaroni1/train'
/home/zju/miniconda3/envs/prompt_ad/lib/python3.10/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
/home/zju/miniconda3/envs/prompt_ad/lib/python3.10/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
Traceback (most recent call last):
  File "/home/zju/mywork/PromptAD/train_cls.py", line 313, in <module>
    main(args)
  File "/home/zju/mywork/PromptAD/train_cls.py", line 213, in main
    train_dataloader, train_dataset_inst = get_dataloader_from_args(phase='train', perturbed=False, transform=model.transform, **kwargs)
  File "/home/zju/mywork/PromptAD/datasets/__init__.py", line 29, in get_dataloader_from_args
    dataset_inst = CLIPDataset(
  File "/home/zju/mywork/PromptAD/datasets/dataset.py", line 18, in __init__
    self.img_paths, self.gt_paths, self.labels, self.types = self.load_dataset(k_shot)  # self.labels => good : 0, anomaly : 1
  File "/home/zju/mywork/PromptAD/datasets/dataset.py", line 23, in load_dataset
    (test_img_tot_paths, test_gt_tot_paths, test_tot_labels, test_tot_types) = self.load_function(self.category,
  File "/home/zju/mywork/PromptAD/datasets/visa.py", line 51, in load_visa
    train_tot_types = load_phase(train_img_path, ground_truth_path)
  File "/home/zju/mywork/PromptAD/datasets/visa.py", line 20, in load_phase
    defect_types = os.listdir(root_path)
FileNotFoundError: [Errno 2] No such file or directory: '/data2/grj/pro_visa/1cls/macaroni2/train'
Traceback (most recent call last):
  File "/home/zju/mywork/PromptAD/train_cls.py", line 313, in <module>
    main(args)
  File "/home/zju/mywork/PromptAD/train_cls.py", line 213, in main
    train_dataloader, train_dataset_inst = get_dataloader_from_args(phase='train', perturbed=False, transform=model.transform, **kwargs)
  File "/home/zju/mywork/PromptAD/datasets/__init__.py", line 29, in get_dataloader_from_args
    dataset_inst = CLIPDataset(
  File "/home/zju/mywork/PromptAD/datasets/dataset.py", line 18, in __init__
    self.img_paths, self.gt_paths, self.labels, self.types = self.load_dataset(k_shot)  # self.labels => good : 0, anomaly : 1
  File "/home/zju/mywork/PromptAD/datasets/dataset.py", line 23, in load_dataset
    (test_img_tot_paths, test_gt_tot_paths, test_tot_labels, test_tot_types) = self.load_function(self.category,
  File "/home/zju/mywork/PromptAD/datasets/visa.py", line 51, in load_visa
    train_tot_types = load_phase(train_img_path, ground_truth_path)
  File "/home/zju/mywork/PromptAD/datasets/visa.py", line 20, in load_phase
    defect_types = os.listdir(root_path)
FileNotFoundError: [Errno 2] No such file or directory: '/data2/grj/pro_visa/1cls/pcb1/train'
/home/zju/miniconda3/envs/prompt_ad/lib/python3.10/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
/home/zju/miniconda3/envs/prompt_ad/lib/python3.10/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
Traceback (most recent call last):
  File "/home/zju/mywork/PromptAD/train_cls.py", line 313, in <module>
    main(args)
  File "/home/zju/mywork/PromptAD/train_cls.py", line 213, in main
    train_dataloader, train_dataset_inst = get_dataloader_from_args(phase='train', perturbed=False, transform=model.transform, **kwargs)
  File "/home/zju/mywork/PromptAD/datasets/__init__.py", line 29, in get_dataloader_from_args
    dataset_inst = CLIPDataset(
  File "/home/zju/mywork/PromptAD/datasets/dataset.py", line 18, in __init__
    self.img_paths, self.gt_paths, self.labels, self.types = self.load_dataset(k_shot)  # self.labels => good : 0, anomaly : 1
  File "/home/zju/mywork/PromptAD/datasets/dataset.py", line 23, in load_dataset
    (test_img_tot_paths, test_gt_tot_paths, test_tot_labels, test_tot_types) = self.load_function(self.category,
  File "/home/zju/mywork/PromptAD/datasets/visa.py", line 51, in load_visa
    train_tot_types = load_phase(train_img_path, ground_truth_path)
  File "/home/zju/mywork/PromptAD/datasets/visa.py", line 20, in load_phase
    defect_types = os.listdir(root_path)
FileNotFoundError: [Errno 2] No such file or directory: '/data2/grj/pro_visa/1cls/pcb2/train'
Traceback (most recent call last):
  File "/home/zju/mywork/PromptAD/train_cls.py", line 313, in <module>
    main(args)
  File "/home/zju/mywork/PromptAD/train_cls.py", line 213, in main
    train_dataloader, train_dataset_inst = get_dataloader_from_args(phase='train', perturbed=False, transform=model.transform, **kwargs)
  File "/home/zju/mywork/PromptAD/datasets/__init__.py", line 29, in get_dataloader_from_args
    dataset_inst = CLIPDataset(
  File "/home/zju/mywork/PromptAD/datasets/dataset.py", line 18, in __init__
    self.img_paths, self.gt_paths, self.labels, self.types = self.load_dataset(k_shot)  # self.labels => good : 0, anomaly : 1
  File "/home/zju/mywork/PromptAD/datasets/dataset.py", line 23, in load_dataset
    (test_img_tot_paths, test_gt_tot_paths, test_tot_labels, test_tot_types) = self.load_function(self.category,
  File "/home/zju/mywork/PromptAD/datasets/visa.py", line 51, in load_visa
    train_tot_types = load_phase(train_img_path, ground_truth_path)
  File "/home/zju/mywork/PromptAD/datasets/visa.py", line 20, in load_phase
    defect_types = os.listdir(root_path)
FileNotFoundError: [Errno 2] No such file or directory: '/data2/grj/pro_visa/1cls/pcb3/train'
/home/zju/miniconda3/envs/prompt_ad/lib/python3.10/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
/home/zju/miniconda3/envs/prompt_ad/lib/python3.10/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
Traceback (most recent call last):
  File "/home/zju/mywork/PromptAD/train_cls.py", line 313, in <module>
    main(args)
  File "/home/zju/mywork/PromptAD/train_cls.py", line 213, in main
    train_dataloader, train_dataset_inst = get_dataloader_from_args(phase='train', perturbed=False, transform=model.transform, **kwargs)
  File "/home/zju/mywork/PromptAD/datasets/__init__.py", line 29, in get_dataloader_from_args
    dataset_inst = CLIPDataset(
  File "/home/zju/mywork/PromptAD/datasets/dataset.py", line 18, in __init__
    self.img_paths, self.gt_paths, self.labels, self.types = self.load_dataset(k_shot)  # self.labels => good : 0, anomaly : 1
  File "/home/zju/mywork/PromptAD/datasets/dataset.py", line 23, in load_dataset
    (test_img_tot_paths, test_gt_tot_paths, test_tot_labels, test_tot_types) = self.load_function(self.category,
  File "/home/zju/mywork/PromptAD/datasets/visa.py", line 51, in load_visa
    train_tot_types = load_phase(train_img_path, ground_truth_path)
  File "/home/zju/mywork/PromptAD/datasets/visa.py", line 20, in load_phase
    defect_types = os.listdir(root_path)
FileNotFoundError: [Errno 2] No such file or directory: '/data2/grj/pro_visa/1cls/pcb4/train'
Traceback (most recent call last):
  File "/home/zju/mywork/PromptAD/train_cls.py", line 313, in <module>
    main(args)
  File "/home/zju/mywork/PromptAD/train_cls.py", line 213, in main
    train_dataloader, train_dataset_inst = get_dataloader_from_args(phase='train', perturbed=False, transform=model.transform, **kwargs)
  File "/home/zju/mywork/PromptAD/datasets/__init__.py", line 29, in get_dataloader_from_args
    dataset_inst = CLIPDataset(
  File "/home/zju/mywork/PromptAD/datasets/dataset.py", line 18, in __init__
    self.img_paths, self.gt_paths, self.labels, self.types = self.load_dataset(k_shot)  # self.labels => good : 0, anomaly : 1
  File "/home/zju/mywork/PromptAD/datasets/dataset.py", line 23, in load_dataset
    (test_img_tot_paths, test_gt_tot_paths, test_tot_labels, test_tot_types) = self.load_function(self.category,
  File "/home/zju/mywork/PromptAD/datasets/visa.py", line 51, in load_visa
    train_tot_types = load_phase(train_img_path, ground_truth_path)
  File "/home/zju/mywork/PromptAD/datasets/visa.py", line 20, in load_phase
    defect_types = os.listdir(root_path)
FileNotFoundError: [Errno 2] No such file or directory: '/data2/grj/pro_visa/1cls/pipe_fryum/train'
/home/zju/miniconda3/envs/prompt_ad/lib/python3.10/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
/home/zju/miniconda3/envs/prompt_ad/lib/python3.10/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)

================================================================================
Object:grid =========================== Image-AUROC:99.0
进程起始时间: 2025-12-20 17:51:58
进程终止时间: 2025-12-20 17:52:35
进程用时: 0小时 0分钟 37秒
================================================================================

/home/zju/miniconda3/envs/prompt_ad/lib/python3.10/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)

================================================================================
Object:carpet =========================== Image-AUROC:100.0
进程起始时间: 2025-12-20 17:51:57
进程终止时间: 2025-12-20 17:53:29
进程用时: 0小时 1分钟 31秒
================================================================================

/home/zju/miniconda3/envs/prompt_ad/lib/python3.10/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)

================================================================================
Object:leather =========================== Image-AUROC:100.0
进程起始时间: 2025-12-20 17:52:38
进程终止时间: 2025-12-20 17:54:05
进程用时: 0小时 1分钟 26秒
================================================================================

/home/zju/miniconda3/envs/prompt_ad/lib/python3.10/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)

================================================================================
Object:tile =========================== Image-AUROC:99.93
进程起始时间: 2025-12-20 17:53:31
进程终止时间: 2025-12-20 17:54:42
进程用时: 0小时 1分钟 11秒
================================================================================

/home/zju/miniconda3/envs/prompt_ad/lib/python3.10/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)

================================================================================
Object:wood =========================== Image-AUROC:99.65
进程起始时间: 2025-12-20 17:54:07
进程终止时间: 2025-12-20 17:55:19
进程用时: 0小时 1分钟 11秒
================================================================================

/home/zju/miniconda3/envs/prompt_ad/lib/python3.10/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)

================================================================================
Object:bottle =========================== Image-AUROC:98.25
进程起始时间: 2025-12-20 17:54:45
进程终止时间: 2025-12-20 17:55:29
进程用时: 0小时 0分钟 43秒
================================================================================

/home/zju/miniconda3/envs/prompt_ad/lib/python3.10/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)

================================================================================
Object:capsule =========================== Image-AUROC:80.65
进程起始时间: 2025-12-20 17:55:32
进程终止时间: 2025-12-20 17:57:06
进程用时: 0小时 1分钟 34秒
================================================================================


================================================================================
Object:cable =========================== Image-AUROC:86.0
进程起始时间: 2025-12-20 17:55:21
进程终止时间: 2025-12-20 17:57:08
进程用时: 0小时 1分钟 47秒
================================================================================

/home/zju/miniconda3/envs/prompt_ad/lib/python3.10/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
/home/zju/miniconda3/envs/prompt_ad/lib/python3.10/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)

================================================================================
Object:metal_nut =========================== Image-AUROC:88.71
进程起始时间: 2025-12-20 17:57:11
进程终止时间: 2025-12-20 17:58:00
进程用时: 0小时 0分钟 49秒
================================================================================

/home/zju/miniconda3/envs/prompt_ad/lib/python3.10/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)

================================================================================
Object:hazelnut =========================== Image-AUROC:91.14
进程起始时间: 2025-12-20 17:57:09
进程终止时间: 2025-12-20 17:58:30
进程用时: 0小时 1分钟 20秒
================================================================================

/home/zju/miniconda3/envs/prompt_ad/lib/python3.10/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)

================================================================================
Object:pill =========================== Image-AUROC:86.12
进程起始时间: 2025-12-20 17:58:03
进程终止时间: 2025-12-20 17:59:23
进程用时: 0小时 1分钟 20秒
================================================================================

/home/zju/miniconda3/envs/prompt_ad/lib/python3.10/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)

================================================================================
Object:screw =========================== Image-AUROC:79.57
进程起始时间: 2025-12-20 17:58:32
进程终止时间: 2025-12-20 17:59:32
进程用时: 0小时 1分钟 0秒
================================================================================

/home/zju/miniconda3/envs/prompt_ad/lib/python3.10/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)

================================================================================
Object:toothbrush =========================== Image-AUROC:89.44
进程起始时间: 2025-12-20 17:59:26
进程终止时间: 2025-12-20 18:00:07
进程用时: 0小时 0分钟 41秒
================================================================================

/home/zju/miniconda3/envs/prompt_ad/lib/python3.10/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)

================================================================================
Object:transistor =========================== Image-AUROC:78.08
进程起始时间: 2025-12-20 17:59:35
进程终止时间: 2025-12-20 18:00:55
进程用时: 0小时 1分钟 20秒
================================================================================

/home/zju/miniconda3/envs/prompt_ad/lib/python3.10/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
Traceback (most recent call last):
  File "/home/zju/mywork/PromptAD/train_cls.py", line 313, in <module>
    main(args)
  File "/home/zju/mywork/PromptAD/train_cls.py", line 213, in main
    train_dataloader, train_dataset_inst = get_dataloader_from_args(phase='train', perturbed=False, transform=model.transform, **kwargs)
  File "/home/zju/mywork/PromptAD/datasets/__init__.py", line 29, in get_dataloader_from_args
    dataset_inst = CLIPDataset(
  File "/home/zju/mywork/PromptAD/datasets/dataset.py", line 18, in __init__
    self.img_paths, self.gt_paths, self.labels, self.types = self.load_dataset(k_shot)  # self.labels => good : 0, anomaly : 1
  File "/home/zju/mywork/PromptAD/datasets/dataset.py", line 23, in load_dataset
    (test_img_tot_paths, test_gt_tot_paths, test_tot_labels, test_tot_types) = self.load_function(self.category,
  File "/home/zju/mywork/PromptAD/datasets/visa.py", line 51, in load_visa
    train_tot_types = load_phase(train_img_path, ground_truth_path)
  File "/home/zju/mywork/PromptAD/datasets/visa.py", line 20, in load_phase
    defect_types = os.listdir(root_path)
FileNotFoundError: [Errno 2] No such file or directory: '/data2/grj/pro_visa/1cls/candle/train'
/home/zju/miniconda3/envs/prompt_ad/lib/python3.10/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
Traceback (most recent call last):
  File "/home/zju/mywork/PromptAD/train_cls.py", line 313, in <module>
    main(args)
  File "/home/zju/mywork/PromptAD/train_cls.py", line 213, in main
    train_dataloader, train_dataset_inst = get_dataloader_from_args(phase='train', perturbed=False, transform=model.transform, **kwargs)
  File "/home/zju/mywork/PromptAD/datasets/__init__.py", line 29, in get_dataloader_from_args
    dataset_inst = CLIPDataset(
  File "/home/zju/mywork/PromptAD/datasets/dataset.py", line 18, in __init__
    self.img_paths, self.gt_paths, self.labels, self.types = self.load_dataset(k_shot)  # self.labels => good : 0, anomaly : 1
  File "/home/zju/mywork/PromptAD/datasets/dataset.py", line 23, in load_dataset
    (test_img_tot_paths, test_gt_tot_paths, test_tot_labels, test_tot_types) = self.load_function(self.category,
  File "/home/zju/mywork/PromptAD/datasets/visa.py", line 51, in load_visa
    train_tot_types = load_phase(train_img_path, ground_truth_path)
  File "/home/zju/mywork/PromptAD/datasets/visa.py", line 20, in load_phase
    defect_types = os.listdir(root_path)
FileNotFoundError: [Errno 2] No such file or directory: '/data2/grj/pro_visa/1cls/capsules/train'

================================================================================
Object:zipper =========================== Image-AUROC:95.46
进程起始时间: 2025-12-20 18:00:10
进程终止时间: 2025-12-20 18:01:07
进程用时: 0小时 0分钟 57秒
================================================================================

/home/zju/miniconda3/envs/prompt_ad/lib/python3.10/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
/home/zju/miniconda3/envs/prompt_ad/lib/python3.10/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
Traceback (most recent call last):
  File "/home/zju/mywork/PromptAD/train_cls.py", line 313, in <module>
    main(args)
  File "/home/zju/mywork/PromptAD/train_cls.py", line 213, in main
    train_dataloader, train_dataset_inst = get_dataloader_from_args(phase='train', perturbed=False, transform=model.transform, **kwargs)
  File "/home/zju/mywork/PromptAD/datasets/__init__.py", line 29, in get_dataloader_from_args
    dataset_inst = CLIPDataset(
  File "/home/zju/mywork/PromptAD/datasets/dataset.py", line 18, in __init__
    self.img_paths, self.gt_paths, self.labels, self.types = self.load_dataset(k_shot)  # self.labels => good : 0, anomaly : 1
  File "/home/zju/mywork/PromptAD/datasets/dataset.py", line 23, in load_dataset
    (test_img_tot_paths, test_gt_tot_paths, test_tot_labels, test_tot_types) = self.load_function(self.category,
  File "/home/zju/mywork/PromptAD/datasets/visa.py", line 51, in load_visa
    train_tot_types = load_phase(train_img_path, ground_truth_path)
  File "/home/zju/mywork/PromptAD/datasets/visa.py", line 20, in load_phase
    defect_types = os.listdir(root_path)
FileNotFoundError: [Errno 2] No such file or directory: '/data2/grj/pro_visa/1cls/cashew/train'
Traceback (most recent call last):
  File "/home/zju/mywork/PromptAD/train_cls.py", line 313, in <module>
    main(args)
  File "/home/zju/mywork/PromptAD/train_cls.py", line 213, in main
    train_dataloader, train_dataset_inst = get_dataloader_from_args(phase='train', perturbed=False, transform=model.transform, **kwargs)
  File "/home/zju/mywork/PromptAD/datasets/__init__.py", line 29, in get_dataloader_from_args
    dataset_inst = CLIPDataset(
  File "/home/zju/mywork/PromptAD/datasets/dataset.py", line 18, in __init__
    self.img_paths, self.gt_paths, self.labels, self.types = self.load_dataset(k_shot)  # self.labels => good : 0, anomaly : 1
  File "/home/zju/mywork/PromptAD/datasets/dataset.py", line 23, in load_dataset
    (test_img_tot_paths, test_gt_tot_paths, test_tot_labels, test_tot_types) = self.load_function(self.category,
  File "/home/zju/mywork/PromptAD/datasets/visa.py", line 51, in load_visa
    train_tot_types = load_phase(train_img_path, ground_truth_path)
  File "/home/zju/mywork/PromptAD/datasets/visa.py", line 20, in load_phase
    defect_types = os.listdir(root_path)
FileNotFoundError: [Errno 2] No such file or directory: '/data2/grj/pro_visa/1cls/chewinggum/train'
/home/zju/miniconda3/envs/prompt_ad/lib/python3.10/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
/home/zju/miniconda3/envs/prompt_ad/lib/python3.10/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
Traceback (most recent call last):
  File "/home/zju/mywork/PromptAD/train_cls.py", line 313, in <module>
    main(args)
  File "/home/zju/mywork/PromptAD/train_cls.py", line 213, in main
    train_dataloader, train_dataset_inst = get_dataloader_from_args(phase='train', perturbed=False, transform=model.transform, **kwargs)
  File "/home/zju/mywork/PromptAD/datasets/__init__.py", line 29, in get_dataloader_from_args
    dataset_inst = CLIPDataset(
  File "/home/zju/mywork/PromptAD/datasets/dataset.py", line 18, in __init__
    self.img_paths, self.gt_paths, self.labels, self.types = self.load_dataset(k_shot)  # self.labels => good : 0, anomaly : 1
  File "/home/zju/mywork/PromptAD/datasets/dataset.py", line 23, in load_dataset
    (test_img_tot_paths, test_gt_tot_paths, test_tot_labels, test_tot_types) = self.load_function(self.category,
  File "/home/zju/mywork/PromptAD/datasets/visa.py", line 51, in load_visa
    train_tot_types = load_phase(train_img_path, ground_truth_path)
  File "/home/zju/mywork/PromptAD/datasets/visa.py", line 20, in load_phase
    defect_types = os.listdir(root_path)
FileNotFoundError: [Errno 2] No such file or directory: '/data2/grj/pro_visa/1cls/fryum/train'
Traceback (most recent call last):
  File "/home/zju/mywork/PromptAD/train_cls.py", line 313, in <module>
    main(args)
  File "/home/zju/mywork/PromptAD/train_cls.py", line 213, in main
    train_dataloader, train_dataset_inst = get_dataloader_from_args(phase='train', perturbed=False, transform=model.transform, **kwargs)
  File "/home/zju/mywork/PromptAD/datasets/__init__.py", line 29, in get_dataloader_from_args
    dataset_inst = CLIPDataset(
  File "/home/zju/mywork/PromptAD/datasets/dataset.py", line 18, in __init__
    self.img_paths, self.gt_paths, self.labels, self.types = self.load_dataset(k_shot)  # self.labels => good : 0, anomaly : 1
  File "/home/zju/mywork/PromptAD/datasets/dataset.py", line 23, in load_dataset
    (test_img_tot_paths, test_gt_tot_paths, test_tot_labels, test_tot_types) = self.load_function(self.category,
  File "/home/zju/mywork/PromptAD/datasets/visa.py", line 51, in load_visa
    train_tot_types = load_phase(train_img_path, ground_truth_path)
  File "/home/zju/mywork/PromptAD/datasets/visa.py", line 20, in load_phase
    defect_types = os.listdir(root_path)
FileNotFoundError: [Errno 2] No such file or directory: '/data2/grj/pro_visa/1cls/macaroni1/train'
/home/zju/miniconda3/envs/prompt_ad/lib/python3.10/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
/home/zju/miniconda3/envs/prompt_ad/lib/python3.10/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
Traceback (most recent call last):
  File "/home/zju/mywork/PromptAD/train_cls.py", line 313, in <module>
    main(args)
  File "/home/zju/mywork/PromptAD/train_cls.py", line 213, in main
    train_dataloader, train_dataset_inst = get_dataloader_from_args(phase='train', perturbed=False, transform=model.transform, **kwargs)
  File "/home/zju/mywork/PromptAD/datasets/__init__.py", line 29, in get_dataloader_from_args
    dataset_inst = CLIPDataset(
  File "/home/zju/mywork/PromptAD/datasets/dataset.py", line 18, in __init__
    self.img_paths, self.gt_paths, self.labels, self.types = self.load_dataset(k_shot)  # self.labels => good : 0, anomaly : 1
  File "/home/zju/mywork/PromptAD/datasets/dataset.py", line 23, in load_dataset
    (test_img_tot_paths, test_gt_tot_paths, test_tot_labels, test_tot_types) = self.load_function(self.category,
  File "/home/zju/mywork/PromptAD/datasets/visa.py", line 51, in load_visa
    train_tot_types = load_phase(train_img_path, ground_truth_path)
  File "/home/zju/mywork/PromptAD/datasets/visa.py", line 20, in load_phase
    defect_types = os.listdir(root_path)
FileNotFoundError: [Errno 2] No such file or directory: '/data2/grj/pro_visa/1cls/macaroni2/train'
Traceback (most recent call last):
  File "/home/zju/mywork/PromptAD/train_cls.py", line 313, in <module>
    main(args)
  File "/home/zju/mywork/PromptAD/train_cls.py", line 213, in main
    train_dataloader, train_dataset_inst = get_dataloader_from_args(phase='train', perturbed=False, transform=model.transform, **kwargs)
  File "/home/zju/mywork/PromptAD/datasets/__init__.py", line 29, in get_dataloader_from_args
    dataset_inst = CLIPDataset(
  File "/home/zju/mywork/PromptAD/datasets/dataset.py", line 18, in __init__
    self.img_paths, self.gt_paths, self.labels, self.types = self.load_dataset(k_shot)  # self.labels => good : 0, anomaly : 1
  File "/home/zju/mywork/PromptAD/datasets/dataset.py", line 23, in load_dataset
    (test_img_tot_paths, test_gt_tot_paths, test_tot_labels, test_tot_types) = self.load_function(self.category,
  File "/home/zju/mywork/PromptAD/datasets/visa.py", line 51, in load_visa
    train_tot_types = load_phase(train_img_path, ground_truth_path)
  File "/home/zju/mywork/PromptAD/datasets/visa.py", line 20, in load_phase
    defect_types = os.listdir(root_path)
FileNotFoundError: [Errno 2] No such file or directory: '/data2/grj/pro_visa/1cls/pcb1/train'
/home/zju/miniconda3/envs/prompt_ad/lib/python3.10/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
/home/zju/miniconda3/envs/prompt_ad/lib/python3.10/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
Traceback (most recent call last):
  File "/home/zju/mywork/PromptAD/train_cls.py", line 313, in <module>
    main(args)
  File "/home/zju/mywork/PromptAD/train_cls.py", line 213, in main
    train_dataloader, train_dataset_inst = get_dataloader_from_args(phase='train', perturbed=False, transform=model.transform, **kwargs)
  File "/home/zju/mywork/PromptAD/datasets/__init__.py", line 29, in get_dataloader_from_args
    dataset_inst = CLIPDataset(
  File "/home/zju/mywork/PromptAD/datasets/dataset.py", line 18, in __init__
    self.img_paths, self.gt_paths, self.labels, self.types = self.load_dataset(k_shot)  # self.labels => good : 0, anomaly : 1
  File "/home/zju/mywork/PromptAD/datasets/dataset.py", line 23, in load_dataset
    (test_img_tot_paths, test_gt_tot_paths, test_tot_labels, test_tot_types) = self.load_function(self.category,
  File "/home/zju/mywork/PromptAD/datasets/visa.py", line 51, in load_visa
    train_tot_types = load_phase(train_img_path, ground_truth_path)
  File "/home/zju/mywork/PromptAD/datasets/visa.py", line 20, in load_phase
    defect_types = os.listdir(root_path)
FileNotFoundError: [Errno 2] No such file or directory: '/data2/grj/pro_visa/1cls/pcb2/train'
Traceback (most recent call last):
  File "/home/zju/mywork/PromptAD/train_cls.py", line 313, in <module>
    main(args)
  File "/home/zju/mywork/PromptAD/train_cls.py", line 213, in main
    train_dataloader, train_dataset_inst = get_dataloader_from_args(phase='train', perturbed=False, transform=model.transform, **kwargs)
  File "/home/zju/mywork/PromptAD/datasets/__init__.py", line 29, in get_dataloader_from_args
    dataset_inst = CLIPDataset(
  File "/home/zju/mywork/PromptAD/datasets/dataset.py", line 18, in __init__
    self.img_paths, self.gt_paths, self.labels, self.types = self.load_dataset(k_shot)  # self.labels => good : 0, anomaly : 1
  File "/home/zju/mywork/PromptAD/datasets/dataset.py", line 23, in load_dataset
    (test_img_tot_paths, test_gt_tot_paths, test_tot_labels, test_tot_types) = self.load_function(self.category,
  File "/home/zju/mywork/PromptAD/datasets/visa.py", line 51, in load_visa
    train_tot_types = load_phase(train_img_path, ground_truth_path)
  File "/home/zju/mywork/PromptAD/datasets/visa.py", line 20, in load_phase
    defect_types = os.listdir(root_path)
FileNotFoundError: [Errno 2] No such file or directory: '/data2/grj/pro_visa/1cls/pcb3/train'
/home/zju/miniconda3/envs/prompt_ad/lib/python3.10/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
/home/zju/miniconda3/envs/prompt_ad/lib/python3.10/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
Traceback (most recent call last):
  File "/home/zju/mywork/PromptAD/train_cls.py", line 313, in <module>
    main(args)
  File "/home/zju/mywork/PromptAD/train_cls.py", line 213, in main
    train_dataloader, train_dataset_inst = get_dataloader_from_args(phase='train', perturbed=False, transform=model.transform, **kwargs)
  File "/home/zju/mywork/PromptAD/datasets/__init__.py", line 29, in get_dataloader_from_args
    dataset_inst = CLIPDataset(
  File "/home/zju/mywork/PromptAD/datasets/dataset.py", line 18, in __init__
    self.img_paths, self.gt_paths, self.labels, self.types = self.load_dataset(k_shot)  # self.labels => good : 0, anomaly : 1
  File "/home/zju/mywork/PromptAD/datasets/dataset.py", line 23, in load_dataset
    (test_img_tot_paths, test_gt_tot_paths, test_tot_labels, test_tot_types) = self.load_function(self.category,
  File "/home/zju/mywork/PromptAD/datasets/visa.py", line 51, in load_visa
    train_tot_types = load_phase(train_img_path, ground_truth_path)
  File "/home/zju/mywork/PromptAD/datasets/visa.py", line 20, in load_phase
    defect_types = os.listdir(root_path)
FileNotFoundError: [Errno 2] No such file or directory: '/data2/grj/pro_visa/1cls/pcb4/train'
Traceback (most recent call last):
  File "/home/zju/mywork/PromptAD/train_cls.py", line 313, in <module>
    main(args)
  File "/home/zju/mywork/PromptAD/train_cls.py", line 213, in main
    train_dataloader, train_dataset_inst = get_dataloader_from_args(phase='train', perturbed=False, transform=model.transform, **kwargs)
  File "/home/zju/mywork/PromptAD/datasets/__init__.py", line 29, in get_dataloader_from_args
    dataset_inst = CLIPDataset(
  File "/home/zju/mywork/PromptAD/datasets/dataset.py", line 18, in __init__
    self.img_paths, self.gt_paths, self.labels, self.types = self.load_dataset(k_shot)  # self.labels => good : 0, anomaly : 1
  File "/home/zju/mywork/PromptAD/datasets/dataset.py", line 23, in load_dataset
    (test_img_tot_paths, test_gt_tot_paths, test_tot_labels, test_tot_types) = self.load_function(self.category,
  File "/home/zju/mywork/PromptAD/datasets/visa.py", line 51, in load_visa
    train_tot_types = load_phase(train_img_path, ground_truth_path)
  File "/home/zju/mywork/PromptAD/datasets/visa.py", line 20, in load_phase
    defect_types = os.listdir(root_path)
FileNotFoundError: [Errno 2] No such file or directory: '/data2/grj/pro_visa/1cls/pipe_fryum/train'
/home/zju/miniconda3/envs/prompt_ad/lib/python3.10/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
/home/zju/miniconda3/envs/prompt_ad/lib/python3.10/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)

================================================================================
Object:grid =========================== Image-AUROC:99.92
进程起始时间: 2025-12-20 18:01:34
进程终止时间: 2025-12-20 18:02:15
进程用时: 0小时 0分钟 40秒
================================================================================

/home/zju/miniconda3/envs/prompt_ad/lib/python3.10/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)

================================================================================
Object:carpet =========================== Image-AUROC:100.0
进程起始时间: 2025-12-20 18:01:33
进程终止时间: 2025-12-20 18:03:10
进程用时: 0小时 1分钟 37秒
================================================================================

/home/zju/miniconda3/envs/prompt_ad/lib/python3.10/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)

================================================================================
Object:leather =========================== Image-AUROC:100.0
进程起始时间: 2025-12-20 18:02:17
进程终止时间: 2025-12-20 18:03:49
进程用时: 0小时 1分钟 31秒
================================================================================

/home/zju/miniconda3/envs/prompt_ad/lib/python3.10/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)

================================================================================
Object:tile =========================== Image-AUROC:99.96
进程起始时间: 2025-12-20 18:03:13
进程终止时间: 2025-12-20 18:04:27
进程用时: 0小时 1分钟 14秒
================================================================================

/home/zju/miniconda3/envs/prompt_ad/lib/python3.10/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)

================================================================================
Object:wood =========================== Image-AUROC:100.0
进程起始时间: 2025-12-20 18:03:51
进程终止时间: 2025-12-20 18:05:08
进程用时: 0小时 1分钟 16秒
================================================================================

/home/zju/miniconda3/envs/prompt_ad/lib/python3.10/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)

================================================================================
Object:bottle =========================== Image-AUROC:97.78
进程起始时间: 2025-12-20 18:04:30
进程终止时间: 2025-12-20 18:05:18
进程用时: 0小时 0分钟 47秒
================================================================================

/home/zju/miniconda3/envs/prompt_ad/lib/python3.10/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)

================================================================================
Object:capsule =========================== Image-AUROC:85.24
进程起始时间: 2025-12-20 18:05:20
进程终止时间: 2025-12-20 18:07:00
进程用时: 0小时 1分钟 39秒
================================================================================

/home/zju/miniconda3/envs/prompt_ad/lib/python3.10/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)

================================================================================
Object:cable =========================== Image-AUROC:93.78
进程起始时间: 2025-12-20 18:05:10
进程终止时间: 2025-12-20 18:07:03
进程用时: 0小时 1分钟 52秒
================================================================================

/home/zju/miniconda3/envs/prompt_ad/lib/python3.10/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)

================================================================================
Object:metal_nut =========================== Image-AUROC:91.2
进程起始时间: 2025-12-20 18:07:05
进程终止时间: 2025-12-20 18:07:57
进程用时: 0小时 0分钟 51秒
================================================================================

/home/zju/miniconda3/envs/prompt_ad/lib/python3.10/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)

================================================================================
Object:hazelnut =========================== Image-AUROC:92.64
进程起始时间: 2025-12-20 18:07:02
进程终止时间: 2025-12-20 18:08:28
进程用时: 0小时 1分钟 25秒
================================================================================

/home/zju/miniconda3/envs/prompt_ad/lib/python3.10/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)

================================================================================
Object:pill =========================== Image-AUROC:87.21
进程起始时间: 2025-12-20 18:08:00
进程终止时间: 2025-12-20 18:09:23
进程用时: 0小时 1分钟 23秒
================================================================================

/home/zju/miniconda3/envs/prompt_ad/lib/python3.10/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)

================================================================================
Object:screw =========================== Image-AUROC:72.02
进程起始时间: 2025-12-20 18:08:30
进程终止时间: 2025-12-20 18:09:33
进程用时: 0小时 1分钟 2秒
================================================================================

/home/zju/miniconda3/envs/prompt_ad/lib/python3.10/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)

================================================================================
Object:toothbrush =========================== Image-AUROC:90.28
进程起始时间: 2025-12-20 18:09:26
进程终止时间: 2025-12-20 18:10:12
进程用时: 0小时 0分钟 45秒
================================================================================

/home/zju/miniconda3/envs/prompt_ad/lib/python3.10/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)

================================================================================
Object:transistor =========================== Image-AUROC:90.08
进程起始时间: 2025-12-20 18:09:36
进程终止时间: 2025-12-20 18:11:00
进程用时: 0小时 1分钟 24秒
================================================================================

/home/zju/miniconda3/envs/prompt_ad/lib/python3.10/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
Traceback (most recent call last):
  File "/home/zju/mywork/PromptAD/train_cls.py", line 313, in <module>
    main(args)
  File "/home/zju/mywork/PromptAD/train_cls.py", line 213, in main
    train_dataloader, train_dataset_inst = get_dataloader_from_args(phase='train', perturbed=False, transform=model.transform, **kwargs)
  File "/home/zju/mywork/PromptAD/datasets/__init__.py", line 29, in get_dataloader_from_args
    dataset_inst = CLIPDataset(
  File "/home/zju/mywork/PromptAD/datasets/dataset.py", line 18, in __init__
    self.img_paths, self.gt_paths, self.labels, self.types = self.load_dataset(k_shot)  # self.labels => good : 0, anomaly : 1
  File "/home/zju/mywork/PromptAD/datasets/dataset.py", line 23, in load_dataset
    (test_img_tot_paths, test_gt_tot_paths, test_tot_labels, test_tot_types) = self.load_function(self.category,
  File "/home/zju/mywork/PromptAD/datasets/visa.py", line 51, in load_visa
    train_tot_types = load_phase(train_img_path, ground_truth_path)
  File "/home/zju/mywork/PromptAD/datasets/visa.py", line 20, in load_phase
    defect_types = os.listdir(root_path)
FileNotFoundError: [Errno 2] No such file or directory: '/data2/grj/pro_visa/1cls/candle/train'
/home/zju/miniconda3/envs/prompt_ad/lib/python3.10/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
Traceback (most recent call last):
  File "/home/zju/mywork/PromptAD/train_cls.py", line 313, in <module>
    main(args)
  File "/home/zju/mywork/PromptAD/train_cls.py", line 213, in main
    train_dataloader, train_dataset_inst = get_dataloader_from_args(phase='train', perturbed=False, transform=model.transform, **kwargs)
  File "/home/zju/mywork/PromptAD/datasets/__init__.py", line 29, in get_dataloader_from_args
    dataset_inst = CLIPDataset(
  File "/home/zju/mywork/PromptAD/datasets/dataset.py", line 18, in __init__
    self.img_paths, self.gt_paths, self.labels, self.types = self.load_dataset(k_shot)  # self.labels => good : 0, anomaly : 1
  File "/home/zju/mywork/PromptAD/datasets/dataset.py", line 23, in load_dataset
    (test_img_tot_paths, test_gt_tot_paths, test_tot_labels, test_tot_types) = self.load_function(self.category,
  File "/home/zju/mywork/PromptAD/datasets/visa.py", line 51, in load_visa
    train_tot_types = load_phase(train_img_path, ground_truth_path)
  File "/home/zju/mywork/PromptAD/datasets/visa.py", line 20, in load_phase
    defect_types = os.listdir(root_path)
FileNotFoundError: [Errno 2] No such file or directory: '/data2/grj/pro_visa/1cls/capsules/train'
/home/zju/miniconda3/envs/prompt_ad/lib/python3.10/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)

================================================================================
Object:zipper =========================== Image-AUROC:96.45
进程起始时间: 2025-12-20 18:10:14
进程终止时间: 2025-12-20 18:11:14
进程用时: 0小时 0分钟 59秒
================================================================================

Traceback (most recent call last):
  File "/home/zju/mywork/PromptAD/train_cls.py", line 313, in <module>
    main(args)
  File "/home/zju/mywork/PromptAD/train_cls.py", line 213, in main
    train_dataloader, train_dataset_inst = get_dataloader_from_args(phase='train', perturbed=False, transform=model.transform, **kwargs)
  File "/home/zju/mywork/PromptAD/datasets/__init__.py", line 29, in get_dataloader_from_args
    dataset_inst = CLIPDataset(
  File "/home/zju/mywork/PromptAD/datasets/dataset.py", line 18, in __init__
    self.img_paths, self.gt_paths, self.labels, self.types = self.load_dataset(k_shot)  # self.labels => good : 0, anomaly : 1
  File "/home/zju/mywork/PromptAD/datasets/dataset.py", line 23, in load_dataset
    (test_img_tot_paths, test_gt_tot_paths, test_tot_labels, test_tot_types) = self.load_function(self.category,
  File "/home/zju/mywork/PromptAD/datasets/visa.py", line 51, in load_visa
    train_tot_types = load_phase(train_img_path, ground_truth_path)
  File "/home/zju/mywork/PromptAD/datasets/visa.py", line 20, in load_phase
    defect_types = os.listdir(root_path)
FileNotFoundError: [Errno 2] No such file or directory: '/data2/grj/pro_visa/1cls/cashew/train'
/home/zju/miniconda3/envs/prompt_ad/lib/python3.10/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
/home/zju/miniconda3/envs/prompt_ad/lib/python3.10/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
Traceback (most recent call last):
  File "/home/zju/mywork/PromptAD/train_cls.py", line 313, in <module>
    main(args)
  File "/home/zju/mywork/PromptAD/train_cls.py", line 213, in main
    train_dataloader, train_dataset_inst = get_dataloader_from_args(phase='train', perturbed=False, transform=model.transform, **kwargs)
  File "/home/zju/mywork/PromptAD/datasets/__init__.py", line 29, in get_dataloader_from_args
    dataset_inst = CLIPDataset(
  File "/home/zju/mywork/PromptAD/datasets/dataset.py", line 18, in __init__
    self.img_paths, self.gt_paths, self.labels, self.types = self.load_dataset(k_shot)  # self.labels => good : 0, anomaly : 1
  File "/home/zju/mywork/PromptAD/datasets/dataset.py", line 23, in load_dataset
    (test_img_tot_paths, test_gt_tot_paths, test_tot_labels, test_tot_types) = self.load_function(self.category,
  File "/home/zju/mywork/PromptAD/datasets/visa.py", line 51, in load_visa
    train_tot_types = load_phase(train_img_path, ground_truth_path)
  File "/home/zju/mywork/PromptAD/datasets/visa.py", line 20, in load_phase
    defect_types = os.listdir(root_path)
FileNotFoundError: [Errno 2] No such file or directory: '/data2/grj/pro_visa/1cls/chewinggum/train'
Traceback (most recent call last):
  File "/home/zju/mywork/PromptAD/train_cls.py", line 313, in <module>
    main(args)
  File "/home/zju/mywork/PromptAD/train_cls.py", line 213, in main
    train_dataloader, train_dataset_inst = get_dataloader_from_args(phase='train', perturbed=False, transform=model.transform, **kwargs)
  File "/home/zju/mywork/PromptAD/datasets/__init__.py", line 29, in get_dataloader_from_args
    dataset_inst = CLIPDataset(
  File "/home/zju/mywork/PromptAD/datasets/dataset.py", line 18, in __init__
    self.img_paths, self.gt_paths, self.labels, self.types = self.load_dataset(k_shot)  # self.labels => good : 0, anomaly : 1
  File "/home/zju/mywork/PromptAD/datasets/dataset.py", line 23, in load_dataset
    (test_img_tot_paths, test_gt_tot_paths, test_tot_labels, test_tot_types) = self.load_function(self.category,
  File "/home/zju/mywork/PromptAD/datasets/visa.py", line 51, in load_visa
    train_tot_types = load_phase(train_img_path, ground_truth_path)
  File "/home/zju/mywork/PromptAD/datasets/visa.py", line 20, in load_phase
    defect_types = os.listdir(root_path)
FileNotFoundError: [Errno 2] No such file or directory: '/data2/grj/pro_visa/1cls/fryum/train'
/home/zju/miniconda3/envs/prompt_ad/lib/python3.10/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
/home/zju/miniconda3/envs/prompt_ad/lib/python3.10/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
Traceback (most recent call last):
  File "/home/zju/mywork/PromptAD/train_cls.py", line 313, in <module>
    main(args)
  File "/home/zju/mywork/PromptAD/train_cls.py", line 213, in main
    train_dataloader, train_dataset_inst = get_dataloader_from_args(phase='train', perturbed=False, transform=model.transform, **kwargs)
  File "/home/zju/mywork/PromptAD/datasets/__init__.py", line 29, in get_dataloader_from_args
    dataset_inst = CLIPDataset(
  File "/home/zju/mywork/PromptAD/datasets/dataset.py", line 18, in __init__
    self.img_paths, self.gt_paths, self.labels, self.types = self.load_dataset(k_shot)  # self.labels => good : 0, anomaly : 1
  File "/home/zju/mywork/PromptAD/datasets/dataset.py", line 23, in load_dataset
    (test_img_tot_paths, test_gt_tot_paths, test_tot_labels, test_tot_types) = self.load_function(self.category,
  File "/home/zju/mywork/PromptAD/datasets/visa.py", line 51, in load_visa
    train_tot_types = load_phase(train_img_path, ground_truth_path)
  File "/home/zju/mywork/PromptAD/datasets/visa.py", line 20, in load_phase
    defect_types = os.listdir(root_path)
FileNotFoundError: [Errno 2] No such file or directory: '/data2/grj/pro_visa/1cls/macaroni1/train'
Traceback (most recent call last):
  File "/home/zju/mywork/PromptAD/train_cls.py", line 313, in <module>
    main(args)
  File "/home/zju/mywork/PromptAD/train_cls.py", line 213, in main
    train_dataloader, train_dataset_inst = get_dataloader_from_args(phase='train', perturbed=False, transform=model.transform, **kwargs)
  File "/home/zju/mywork/PromptAD/datasets/__init__.py", line 29, in get_dataloader_from_args
    dataset_inst = CLIPDataset(
  File "/home/zju/mywork/PromptAD/datasets/dataset.py", line 18, in __init__
    self.img_paths, self.gt_paths, self.labels, self.types = self.load_dataset(k_shot)  # self.labels => good : 0, anomaly : 1
  File "/home/zju/mywork/PromptAD/datasets/dataset.py", line 23, in load_dataset
    (test_img_tot_paths, test_gt_tot_paths, test_tot_labels, test_tot_types) = self.load_function(self.category,
  File "/home/zju/mywork/PromptAD/datasets/visa.py", line 51, in load_visa
    train_tot_types = load_phase(train_img_path, ground_truth_path)
  File "/home/zju/mywork/PromptAD/datasets/visa.py", line 20, in load_phase
    defect_types = os.listdir(root_path)
FileNotFoundError: [Errno 2] No such file or directory: '/data2/grj/pro_visa/1cls/macaroni2/train'
/home/zju/miniconda3/envs/prompt_ad/lib/python3.10/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
/home/zju/miniconda3/envs/prompt_ad/lib/python3.10/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
Traceback (most recent call last):
  File "/home/zju/mywork/PromptAD/train_cls.py", line 313, in <module>
    main(args)
  File "/home/zju/mywork/PromptAD/train_cls.py", line 213, in main
    train_dataloader, train_dataset_inst = get_dataloader_from_args(phase='train', perturbed=False, transform=model.transform, **kwargs)
  File "/home/zju/mywork/PromptAD/datasets/__init__.py", line 29, in get_dataloader_from_args
    dataset_inst = CLIPDataset(
  File "/home/zju/mywork/PromptAD/datasets/dataset.py", line 18, in __init__
    self.img_paths, self.gt_paths, self.labels, self.types = self.load_dataset(k_shot)  # self.labels => good : 0, anomaly : 1
  File "/home/zju/mywork/PromptAD/datasets/dataset.py", line 23, in load_dataset
    (test_img_tot_paths, test_gt_tot_paths, test_tot_labels, test_tot_types) = self.load_function(self.category,
  File "/home/zju/mywork/PromptAD/datasets/visa.py", line 51, in load_visa
    train_tot_types = load_phase(train_img_path, ground_truth_path)
  File "/home/zju/mywork/PromptAD/datasets/visa.py", line 20, in load_phase
    defect_types = os.listdir(root_path)
FileNotFoundError: [Errno 2] No such file or directory: '/data2/grj/pro_visa/1cls/pcb1/train'
Traceback (most recent call last):
  File "/home/zju/mywork/PromptAD/train_cls.py", line 313, in <module>
    main(args)
  File "/home/zju/mywork/PromptAD/train_cls.py", line 213, in main
    train_dataloader, train_dataset_inst = get_dataloader_from_args(phase='train', perturbed=False, transform=model.transform, **kwargs)
  File "/home/zju/mywork/PromptAD/datasets/__init__.py", line 29, in get_dataloader_from_args
    dataset_inst = CLIPDataset(
  File "/home/zju/mywork/PromptAD/datasets/dataset.py", line 18, in __init__
    self.img_paths, self.gt_paths, self.labels, self.types = self.load_dataset(k_shot)  # self.labels => good : 0, anomaly : 1
  File "/home/zju/mywork/PromptAD/datasets/dataset.py", line 23, in load_dataset
    (test_img_tot_paths, test_gt_tot_paths, test_tot_labels, test_tot_types) = self.load_function(self.category,
  File "/home/zju/mywork/PromptAD/datasets/visa.py", line 51, in load_visa
    train_tot_types = load_phase(train_img_path, ground_truth_path)
  File "/home/zju/mywork/PromptAD/datasets/visa.py", line 20, in load_phase
    defect_types = os.listdir(root_path)
FileNotFoundError: [Errno 2] No such file or directory: '/data2/grj/pro_visa/1cls/pcb2/train'
/home/zju/miniconda3/envs/prompt_ad/lib/python3.10/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
/home/zju/miniconda3/envs/prompt_ad/lib/python3.10/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
Traceback (most recent call last):
  File "/home/zju/mywork/PromptAD/train_cls.py", line 313, in <module>
    main(args)
  File "/home/zju/mywork/PromptAD/train_cls.py", line 213, in main
    train_dataloader, train_dataset_inst = get_dataloader_from_args(phase='train', perturbed=False, transform=model.transform, **kwargs)
  File "/home/zju/mywork/PromptAD/datasets/__init__.py", line 29, in get_dataloader_from_args
    dataset_inst = CLIPDataset(
  File "/home/zju/mywork/PromptAD/datasets/dataset.py", line 18, in __init__
    self.img_paths, self.gt_paths, self.labels, self.types = self.load_dataset(k_shot)  # self.labels => good : 0, anomaly : 1
  File "/home/zju/mywork/PromptAD/datasets/dataset.py", line 23, in load_dataset
    (test_img_tot_paths, test_gt_tot_paths, test_tot_labels, test_tot_types) = self.load_function(self.category,
  File "/home/zju/mywork/PromptAD/datasets/visa.py", line 51, in load_visa
    train_tot_types = load_phase(train_img_path, ground_truth_path)
  File "/home/zju/mywork/PromptAD/datasets/visa.py", line 20, in load_phase
    defect_types = os.listdir(root_path)
FileNotFoundError: [Errno 2] No such file or directory: '/data2/grj/pro_visa/1cls/pcb3/train'
Traceback (most recent call last):
  File "/home/zju/mywork/PromptAD/train_cls.py", line 313, in <module>
    main(args)
  File "/home/zju/mywork/PromptAD/train_cls.py", line 213, in main
    train_dataloader, train_dataset_inst = get_dataloader_from_args(phase='train', perturbed=False, transform=model.transform, **kwargs)
  File "/home/zju/mywork/PromptAD/datasets/__init__.py", line 29, in get_dataloader_from_args
    dataset_inst = CLIPDataset(
  File "/home/zju/mywork/PromptAD/datasets/dataset.py", line 18, in __init__
    self.img_paths, self.gt_paths, self.labels, self.types = self.load_dataset(k_shot)  # self.labels => good : 0, anomaly : 1
  File "/home/zju/mywork/PromptAD/datasets/dataset.py", line 23, in load_dataset
    (test_img_tot_paths, test_gt_tot_paths, test_tot_labels, test_tot_types) = self.load_function(self.category,
  File "/home/zju/mywork/PromptAD/datasets/visa.py", line 51, in load_visa
    train_tot_types = load_phase(train_img_path, ground_truth_path)
  File "/home/zju/mywork/PromptAD/datasets/visa.py", line 20, in load_phase
    defect_types = os.listdir(root_path)
FileNotFoundError: [Errno 2] No such file or directory: '/data2/grj/pro_visa/1cls/pcb4/train'
/home/zju/miniconda3/envs/prompt_ad/lib/python3.10/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
Traceback (most recent call last):
  File "/home/zju/mywork/PromptAD/train_cls.py", line 313, in <module>
    main(args)
  File "/home/zju/mywork/PromptAD/train_cls.py", line 213, in main
    train_dataloader, train_dataset_inst = get_dataloader_from_args(phase='train', perturbed=False, transform=model.transform, **kwargs)
  File "/home/zju/mywork/PromptAD/datasets/__init__.py", line 29, in get_dataloader_from_args
    dataset_inst = CLIPDataset(
  File "/home/zju/mywork/PromptAD/datasets/dataset.py", line 18, in __init__
    self.img_paths, self.gt_paths, self.labels, self.types = self.load_dataset(k_shot)  # self.labels => good : 0, anomaly : 1
  File "/home/zju/mywork/PromptAD/datasets/dataset.py", line 23, in load_dataset
    (test_img_tot_paths, test_gt_tot_paths, test_tot_labels, test_tot_types) = self.load_function(self.category,
  File "/home/zju/mywork/PromptAD/datasets/visa.py", line 51, in load_visa
    train_tot_types = load_phase(train_img_path, ground_truth_path)
  File "/home/zju/mywork/PromptAD/datasets/visa.py", line 20, in load_phase
    defect_types = os.listdir(root_path)
FileNotFoundError: [Errno 2] No such file or directory: '/data2/grj/pro_visa/1cls/pipe_fryum/train'
python train_cls.py --dataset visa --gpu-id 0 --k-shot 4 --class_name pcb2 --root-dir ./result/prompt1
python train_cls.py --dataset visa --gpu-id 0 --k-shot 4 --class_name pcb3 --root-dir ./result/prompt1
python train_cls.py --dataset visa --gpu-id 0 --k-shot 4 --class_name pcb4 --root-dir ./result/prompt1
python train_cls.py --dataset visa --gpu-id 0 --k-shot 4 --class_name pipe_fryum --root-dir ./result/prompt1

================================================================================
主程序终止时间: 2025-12-20 18:11:39
主程序总用时: 0小时 29分钟 1秒
================================================================================

